(function(){"use strict";var t={7541:function(t,e,s){var a=s(7195),i=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"body"}},[e("meta",{attrs:{name:"viewport",content:"width=device-width, initial-scale=1.0"}}),t.logged_in?e("div",{staticClass:"main"},[e("NavBar"),e("router-view"),e("div",{staticClass:"loggout",on:{click:t.loggout}},[e("fa",{attrs:{icon:"power-off"}})],1)],1):e("div",[e("Login")],1)])},r=[],o=s(8428),n=s.n(o),l=function(){var t=this,e=t._self._c;return e("div",{staticClass:"centered"},[e("form",{attrs:{action:".",method:"post"}},[e("center",[e("h2",{staticStyle:{"text-transform":"uppercase"}},[t._v("chicken breeding")]),e("img",{attrs:{src:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSE0Xu_rtvk8mygc60iDSxns0rxJh2cJs7gzA&usqp=CAU",alt:"",width:"100%",height:"50%"}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_username"}},[t._v("Username:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],attrs:{type:"text",name:"username",placeholder:"Username ",required:"",id:"id_username",autocomplete:"on"},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_password"}},[t._v("Password:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{type:"password",name:"password",placeholder:"Password ",required:"",id:"id_password",autocomplete:"on"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),t.logs.length>0?e("label",{staticStyle:{color:"red"},attrs:{for:"id_password"}},[t._v(t._s(t.logs)+" ")]):t._e(),e("div",{staticClass:"btns"},[e("button",{on:{click:function(e){return e.preventDefault(),t.logIn.apply(null,arguments)}}},[t._v("Log In")])]),e("center",[t._v(" Developped by "),e("b",[e("a",{attrs:{href:"https://github.com/Desire1990"}},[t._v("Desos")])])])],1)])},u=[],c={data(){return{logs:"",username:"",password:"",url:this.$store.state.url}},methods:{logIn(){this.logs="loging in...",n().post(this.url+"/login/",{username:this.username,password:this.password}).then((t=>{this.$store.state.user=t.data})).catch((t=>{t.response?this.logs=JSON.stringify(t.response.data):this.logs="erreur de connectivité"}))}}},d=c,h=s(1001),p=(0,h.Z)(d,l,u,!1,null,"c79e1af0",null),m=p.exports,v=function(){var t=this,e=t._self._c;return e("center",{staticClass:"parent"},[e("img",{attrs:{src:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSE0Xu_rtvk8mygc60iDSxns0rxJh2cJs7gzA&usqp=CAU",alt:"",width:"100px",height:"50px"}}),e("router-link",{attrs:{to:"/home"}},[e("div",{staticClass:"icon"},[e("fa",{attrs:{icon:"shopping-cart"}})],1),t._v(" HOME ")]),e("router-link",{attrs:{to:"/stock",event:""},nativeOn:{mouseenter:function(e){return(e=>t.showSubmenu(e)).apply(null,arguments)},mouseleave:function(e){return(e=>t.hideSubmenu(e)).apply(null,arguments)}}},[e("div",{staticClass:"icon"},[e("fa",{attrs:{icon:"hand-holding-usd"}})],1),t._v(" STOCK "),e("div",{staticClass:"submenu"},[e("router-link",{attrs:{to:{name:"produit"}}},[e("fa",{attrs:{icon:"hand-holding-usd"}}),t._v(" Produits ")],1),e("router-link",{attrs:{to:{name:"salle"}}},[e("fa",{attrs:{icon:"hand-holding-usd"}}),t._v(" Salle ")],1),e("router-link",{attrs:{to:{name:"oeuf"}}},[e("fa",{attrs:{icon:"hand-holding-usd"}}),t._v(" Oeufs ")],1)],1)]),e("router-link",{attrs:{to:"/hist",event:""},nativeOn:{mouseenter:function(e){return(e=>t.showSubmenu(e)).apply(null,arguments)},mouseleave:function(e){return(e=>t.hideSubmenu(e)).apply(null,arguments)}}},[e("div",{staticClass:"icon"},[e("fa",{attrs:{icon:"hand-holding-usd"}})],1),t._v(" HISTORIQUES "),e("div",{staticClass:"submenu"},[e("router-link",{attrs:{to:{name:"achats"}}},[e("fa",{attrs:{icon:"hand-holding-usd"}}),t._v(" Achats ")],1),e("router-link",{attrs:{to:{name:"rations"}}},[e("fa",{attrs:{icon:"hand-holding-usd"}}),t._v(" Rations ")],1),e("router-link",{attrs:{to:{name:"oeuf_vendu"}}},[e("fa",{attrs:{icon:"hand-holding-usd"}}),t._v(" Oeufs vendus ")],1),e("router-link",{attrs:{to:{name:"poulet_vendu"}}},[e("fa",{attrs:{icon:"hand-holding-usd"}}),e("span",[t._v("Poulets vendus")])],1)],1)]),t.is_admin||t.userIs("gerant")?e("router-link",{attrs:{to:"/stats",event:""},nativeOn:{mouseenter:function(e){return(e=>t.showSubmenu(e)).apply(null,arguments)},mouseleave:function(e){return(e=>t.hideSubmenu(e)).apply(null,arguments)}}},[e("div",{staticClass:"icon"},[e("fa",{attrs:{icon:"chart-bar"}})],1),t._v(" STATISTIQUES "),e("div",{staticClass:"submenu"},[e("router-link",{attrs:{to:{name:"statsproduct"}}},[e("fa",{attrs:{icon:"chart-bar"}}),t._v(" Produits ")],1),e("router-link",{attrs:{to:{name:"statsclients"}}},[e("fa",{attrs:{icon:"chart-bar"}}),t._v(" Clientèles ")],1),e("router-link",{attrs:{to:{name:"statspertes"}}},[e("fa",{attrs:{icon:"chart-bar"}}),t._v(" Pertes ")],1)],1)]):t._e(),e("router-link",{attrs:{to:"/poulets"}},[e("div",{staticClass:"icon"},[e("fa",{attrs:{icon:"trash-alt"}})],1),t._v(" PERTES ")]),t.$store.state.user.groups.includes("admin")?e("router-link",{attrs:{to:"/users"}},[e("div",{staticClass:"icon"},[e("fa",{attrs:{icon:"users"}})],1),t._v(" UTILISATEURS ")]):t._e(),e("router-link",{attrs:{to:"/transactions"}},[e("div",{staticClass:"icon"},[e("fa",{attrs:{icon:"hand-holding-usd"}})],1),t._v(" TRANSACTIONS ")]),e("br"),e("br"),e("br"),e("div",[e("h2",[t._v(t._s(this.user.username))])])],1)},_=[],f={computed:{is_admin(){return this.$store.state.user.is_admin}},methods:{showSubmenu(t){let e=t.target.getElementsByClassName("submenu")[0];e.style.display="block"},hideSubmenu(t){let e=t.target.getElementsByClassName("submenu")[0];e.style.display="none"}}},g=f,b=(0,h.Z)(g,v,_,!1,null,"363acdd1",null),y=b.exports,x={components:{NavBar:y,Login:m},computed:{logged_in(){return null!=this.$store.state.user}},mounted(){var t=JSON.parse(localStorage.getItem("user"));t?this.$store.state.user=t:console.warn("il y'a pas de session"),0==this.$store.state.produits.length&&this.fetchProducts()},watch:{"$store.state.user":{deep:!0,handler(t){localStorage.setItem("user",JSON.stringify(t))}}},methods:{loggout(){confirm("êtes vous sur de vouloir deconnecter?")&&(this.$store.state.user=null)},fetchProducts(){let t={headers:{Authorization:"Bearer "+this.$store.state.user.access}};n().get(this.$store.state.url+"/produit/",t).then((t=>{this.$store.state.produits=t.data,this.items=t.data})).catch((t=>{console.error(t)}))}}},$=x,C=(0,h.Z)($,i,r,!1,null,null,null),w=C.exports,q=s(2241),k=function(){var t=this,e=t._self._c;return e("div",{staticClass:"parent"},[e("SearchBar",{attrs:{show_date:!1},on:{searched:t.performFilter}}),e("div",{staticClass:"page"},[e("div",{staticClass:"items"},[e("div",{staticClass:"recycler"},t._l(t.non_empty_items,(function(t){return e("Item",{key:t.id,attrs:{item:t}})})),1),e("hr",{staticStyle:{margin:"20px 0"}}),e("div",{staticClass:"recycler"},t._l(t.empty_items,(function(t){return e("Item",{key:t.id,attrs:{item:t}})})),1)]),t.panier_shown?e("div",{staticClass:"cart"},[e("span",{staticClass:"close_panier",on:{click:function(e){t.panier_shown=!1}}},[t._v("x")]),e("h3",{staticClass:"title"},[t._v("Panier")]),e("div",{staticClass:"panier_items"},t._l(t.cart.content,(function(t){return e("CartItem",{key:t.id,attrs:{item:t}})})),1),e("div",{staticClass:"totals"},[e("div",[t._v(" Total ")]),e("div",[e("b",[t._v(t._s(t.money(t.cart.getTotal())))]),t._v(" Fbu")])]),t.cart.getLength()?e("div",{staticClass:"cart_buttons"},[e("button",{on:{click:function(e){t.cart.content=[]}}},[t._v("reset")]),e("button",{on:{click:function(e){t.confirm_vente=!0}}},[t._v("valider")])]):t._e()]):e("div",{staticClass:"btn_panier",on:{click:function(e){t.panier_shown=!0}}},[t._v(" panier("+t._s(t.cart.getLength())+") ")])])],1)},P=[],D=function(){var t=this,e=t._self._c;return e("div",{staticClass:"center"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword,expression:"keyword"}],attrs:{type:"text",placeholder:"Keyword",id:"id_username",autofocus:""},domProps:{value:t.keyword},on:{keydown:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.keyword=e.target.value)}}}),e("button",{attrs:{type:"reset"},on:{click:function(e){t.keyword=""}}},[t._v("×")]),t.show_date?e("div",{staticStyle:{display:"inline"}},[e("button",{staticStyle:{"margin-left":"0"},on:{click:function(e){t.triggered=!t.triggered}}},[t._v(" Date ")]),t.triggered?e("div",{staticClass:"form"},[e("label",[t._v("Du:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.date.du,expression:"date.du"}],attrs:{type:"date",name:"date_du"},domProps:{value:t.date.du},on:{input:function(e){e.target.composing||t.$set(t.date,"du",e.target.value)}}}),e("label",[t._v("Au:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.date.au,expression:"date.au"}],attrs:{type:"date",name:"date_au"},domProps:{value:t.date.au},on:{input:function(e){e.target.composing||t.$set(t.date,"au",e.target.value)}}}),e("input",{staticStyle:{border:"1px solid black"},attrs:{type:"submit",value:"search"},on:{click:t.performSearch}})]):t._e()]):t._e()])},S=[],B={props:{show_date:{type:Boolean,default:!0}},components:{},data(){return{keyword:"",date:{du:null,au:null},triggered:!1}},watch:{keyword(t){this.$emit("searched",t)}},methods:{performSearch(){this.triggered=!1,this.$emit("changed",this.date)},changeColor(t){"red"==t&&(document.documentElement.style.setProperty("--primary","#d55"),document.documentElement.style.setProperty("--primary-light","#faa"),document.documentElement.style.setProperty("--hover","#faa")),"green"==t&&(document.documentElement.style.setProperty("--primary","green"),document.documentElement.style.setProperty("--primary-light","#595"),document.documentElement.style.setProperty("--hover","#595")),"blue"==t&&(document.documentElement.style.setProperty("--primary","#08a"),document.documentElement.style.setProperty("--primary-light","lightblue"),document.documentElement.style.setProperty("--hover","#29b"))}}},A=B,N=(0,h.Z)(A,D,S,!1,null,"30aac440",null),T=N.exports,O=function(){var t=this,e=t._self._c;return e("div",{class:{parent:!0,danger:0==t.item.quantite_oeuf},attrs:{"data-id":t.item.id}},[e("div",{staticStyle:{"flex-grow":"1"}},[e("span",{staticClass:"name"},[t._v(" "+t._s(t.item.nom))]),e("div",{staticClass:"prix"},[t._v(" "+t._s(t.money(500))+" Fbu")])]),e("div",{staticClass:"qtt"},[t._v(" quantité dispo: "),e("span",{staticClass:"dispo"},[t._v(" "+t._s(t.item.quantite_oeuf)+" oeufs ")])]),e("div",{staticClass:"buttons"},[e("button",{staticClass:"bg-blue",on:{click:t.decreaseQtt}},[t._v("-")]),t.editable?e("input",{directives:[{name:"model",rawName:"v-model",value:t.qtt,expression:"qtt"}],staticClass:"item_qtt",attrs:{type:"number",max:t.item.quantite_oeuf},domProps:{value:t.qtt},on:{keydown:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.qtt=e.target.value)}}}):e("label",{on:{click:t.enableEdition}},[t._v(t._s(t.qtt))]),e("button",{staticClass:"bg-blue",on:{click:t.increaseQtt}},[t._v("+")])])])},L=[],I={props:{item:{type:Object,required:!0}},data(){return{cart:this.$store.state.cart,editable:!1}},methods:{getIcon(t){return null==t.image?"/img/item.png":t.image},increaseQtt:function(){this.cart.add(this.item)},decreaseQtt:function(){this.cart.decrease(this.item.id)},enableEdition(){0!=this.item.quantite_oeuf&&(this.editable=!0)}},computed:{qtt:{get(){return this.cart.getQuantite(this.item.id)},set(t){0!=t.length&&this.cart.add(this.item,t)}}}},E=I,F=(0,h.Z)(E,O,L,!1,null,"7a78873b",null),z=F.exports,Z=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container"},[e("button",{staticClass:"cart_button",on:{click:function(e){return t.cart.decrease(t.item.product.id)}}},[t._v("- ")]),e("button",{staticClass:"cart_button",on:{click:function(e){return t.cart.increase(t.item.product.id)}}},[t._v("+ ")]),e("div",{staticClass:"cart_body"},[e("div",[e("b",[t._v(t._s(t.item.quantite))]),t._v(" x Oeufs "),e("fa",{staticStyle:{color:"#b55"},attrs:{icon:"trash-alt"},on:{click:function(e){return t.remove(t.item)}}})],1),e("div",[e("b",[t._v(t._s(t.money(t.item.getTotale())))]),t._v(" Fbu ")])])])},j=[],U={props:{item:{type:Object,required:!0}},computed:{cart(){return this.$store.state.cart}},methods:{remove(t){let e=this.cart.find(t.product.id);this.cart.content.splice(e,1)}}},V=U,R=(0,h.Z)(V,Z,j,!1,null,"5f915766",null),Q=R.exports,J=function(){var t=this,e=t._self._c;return e("div",{class:{popup:!0,active:t.visible},on:{click:t.close}},[e("div",{staticClass:"popup-body",on:{click:function(t){t.preventDefault(),t.stopPropagation()},keydown:function(t){t.stopPropagation()}}},[e("center",[e("h3",[t._v("Ration Journalière")])]),e("form",{attrs:{method:"post"}},[e("div",[t._v(" La somme à consommer "),e("b",[t._v(t._s(t.money(t.cart.getTotal())))]),t._v("Fbu ")]),e("hr"),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_nom"}},[t._v("Nom du responsable")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.responsable.nom,expression:"responsable.nom"}],attrs:{type:"text",list:"noms",id:"id_nom"},domProps:{value:t.responsable.nom},on:{change:t.setTel,input:function(e){e.target.composing||t.$set(t.responsable,"nom",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_tel"}},[t._v("Téléphone")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.responsable.telephone,expression:"responsable.telephone"}],attrs:{type:"text",id:"id_tel",list:"tels"},domProps:{value:t.responsable.telephone},on:{change:t.setNom,input:function(e){e.target.composing||t.$set(t.responsable,"telephone",e.target.value)}}})]),e("div",{staticClass:"buttons"},[e("div",{staticClass:"logs"},[t._v(t._s(t.logs))]),e("input",{attrs:{type:"submit",value:"Valider"},on:{click:t.postCommande}})])]),e("datalist",{attrs:{id:"noms"}},t._l(t.responsables,(function(t){return e("option",{domProps:{value:t.nom}})})),0),e("datalist",{attrs:{id:"tels"}},t._l(t.responsables,(function(t){return e("option",{domProps:{value:t.telephone}})})),0)],1)])},M=[],G=(s(541),{props:{visible:{type:Boolean,default:!1}},data(){return{responsable:{nom:"",telephone:""},cart:this.$store.state.cart,dette_p:null,logs:""}},computed:{payee:{get(){return null==this.dette_p?this.cart.getTotal():this.dette_p},set(t){this.dette_p=t}},responsables(){return this.$store.state.responsables},host(){return this.$store.state.url},username(){return this.$store.state.user.username},headers(){return{headers:{Authorization:"Bearer "+this.$store.state.user.access}}}},mounted(){n().get(this.$store.state.url+"/responsable/",this.headers).then((t=>{this.$store.state.responsables=t.data.results})).catch((t=>{}))},methods:{close(){this.$emit("close")},setTel(){for(let t of this.responsables)if(t.nom==this.responsable.nom)return void(this.responsable.telephone=t.telephone)},setNom(){for(let t of this.responsables)if(t.telephone==this.responsable.telephone)return void(this.responsable.nom=t.nom)},postCommande(){if(this.payee<this.cart.getTotal()&&this.responsable.telephone.length<7)return void(this.logs="le numero est obligatoire pour les dettes");let t={},e=[],s=this.cart.getTotal(),a=this.payee<=s?this.payee:s,i=this.payee==this.cart.getTotal();for(let r of this.cart.content)e.unshift({id:r.product.id,quantite:r.quantite});t={items:e,responsable:this.responsable,payee:a,validated:i,a_payer:s},n().post(this.$store.state.url+"/ration/",t,this.headers).then((t=>{let s,a=t.data,i=this.$store.state.produits;this.responsable={nom:"",telephone:""},this.$store.state.cart.content=[],this.$store.state.rations.unshift(a),this.$emit("close");for(let r of e)s=i.find((t=>t.id==r.id)),s&&(s.quantite-=r.quantite)})).catch((t=>{t.response?this.logs=t.response.data.status:(this.logs="une erreur est survenue",console.error(t))}))}}}),H=G,K=(0,h.Z)(H,J,M,!1,null,"34a8c1b4",null),X=K.exports,W={components:{SearchBar:T,Item:z,CartItem:Q,DialogSubmit:X},data(){return{items:this.$store.state.salles,cart:this.$store.state.cart,panier_shown:!0,confirm_vente:!1,to_search:""}},computed:{non_empty_items(){return this.items.filter((t=>t.quantite_oeuf>0))},empty_items(){return this.items.filter((t=>0==t.quantite_oeuf))}},methods:{performFilter(t){let e=this.$store.state.salles.filter((e=>e.id==t|e.nom.toLowerCase().includes(t.toLowerCase())));this.items=e},fetchProducts(){let t={headers:{Authorization:"Bearer "+this.$store.state.user.access}};n().get(this.$store.state.url+"/salle/",t).then((t=>{this.$store.state.salles=t.data.results,this.items=t.data.results})).catch((t=>{if("token_not_valid"==t.response.data.code){let t={refresh:this.$store.state.user.refresh};n().post(this.$store.state.url+"/refresh/",t).then((t=>{this.$store.state.user.access=t.data.access,this.fetchProducts()})).catch((t=>{this.$store.state.user=null}))}}))}},mounted(){this.$store.state.salles.length<1&&this.fetchProducts(),document.onkeydown=t=>{if("/home/ration"!==location.pathname)return;this.to_search+=t.key;let e=setTimeout((()=>{for(let t of this.$store.state.salles)if(t.id==this.to_search){this.cart.add(t);break}clearTimeout(e),this.to_search=""}),200)}}},Y=W,tt=(0,h.Z)(Y,k,P,!1,null,null,null),et=(tt.exports,function(){var t=this,e=t._self._c;return e("div",{staticClass:"parent"},[e("SearchBar",{attrs:{show_date:!1},on:{searched:t.performFilter}}),e("div",{staticClass:"page"},[e("div",{staticClass:"items"},[e("div",{staticClass:"recycler"},t._l(t.non_empty_items,(function(t){return e("Item",{key:t.id,attrs:{item:t}})})),1),e("hr",{staticStyle:{margin:"20px 0"}}),e("div",{staticClass:"recycler"},t._l(t.empty_items,(function(t){return e("Item",{key:t.id,attrs:{item:t}})})),1)]),t.panier_shown?e("div",{staticClass:"cart"},[e("span",{staticClass:"close_panier",on:{click:function(e){t.panier_shown=!1}}},[t._v("x")]),e("h3",{staticClass:"title"},[t._v("Panier")]),e("hr"),e("div",{staticClass:"panier_items"},t._l(t.cart.content,(function(t){return e("CartItem",{key:t.id,attrs:{item:t}})})),1),e("div",{staticClass:"totals"},[e("div",[t._v(" Total ")]),e("div",[e("b",[t._v(t._s(t.money(t.cart.getTotal())))]),t._v(" Fbu")])]),t.cart.getLength()?e("div",{staticClass:"cart_buttons"},[e("button",{on:{click:function(e){t.cart.content=[]}}},[t._v("reset")]),e("button",{on:{click:function(e){t.confirm_vente=!0}}},[t._v("valider")])]):t._e()]):e("div",{staticClass:"btn_panier",on:{click:function(e){t.panier_shown=!0}}},[t._v(" panier("+t._s(t.cart.getLength())+") ")])]),e("DialogSubmit",{attrs:{visible:t.confirm_vente},on:{close:function(e){t.confirm_vente=!1}}})],1)}),st=[],at=function(){var t=this,e=t._self._c;return e("div",{class:{parent:!0,danger:0==t.item.quantite},attrs:{"data-id":t.item.id}},[e("div",{staticStyle:{"flex-grow":"1"}},[e("span",{staticClass:"name"},[t._v(" "+t._s(t.item.nom))]),e("div",{staticClass:"prix"},[t._v(" "+t._s(t.money(t.item.prix_unitaire))+" Fbu")])]),e("div",{staticClass:"qtt"},[t._v(" quantité dispo: "),e("span",{staticClass:"dispo"},[t._v(" "+t._s(t.item.quantite)+" "+t._s(t.item.unite)+" ")])]),e("div",{staticClass:"buttons"},[e("button",{staticClass:"bg-blue",on:{click:t.decreaseQtt}},[t._v("-")]),t.editable?e("input",{directives:[{name:"model",rawName:"v-model",value:t.qtt,expression:"qtt"}],staticClass:"item_qtt",attrs:{type:"number",max:t.item.quantite},domProps:{value:t.qtt},on:{keydown:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.qtt=e.target.value)}}}):e("label",{on:{click:t.enableEdition}},[t._v(t._s(t.qtt))]),e("button",{staticClass:"bg-blue",on:{click:t.increaseQtt}},[t._v("+")])])])},it=[],rt={props:{item:{type:Object,required:!0}},data(){return{cart:this.$store.state.cart,editable:!1}},methods:{getIcon(t){return null==t.image?"/img/item.png":t.image},increaseQtt:function(){this.cart.add(this.item)},decreaseQtt:function(){this.cart.decrease(this.item.id)},enableEdition(){0!=this.item.quantite&&(this.editable=!0)}},computed:{qtt:{get(){return this.cart.getQuantite(this.item.id)},set(t){0!=t.length&&this.cart.add(this.item,t)}}}},ot=rt,nt=(0,h.Z)(ot,at,it,!1,null,"63e71cf8",null),lt=nt.exports,ut=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container"},[e("button",{staticClass:"cart_button",on:{click:function(e){return t.cart.decrease(t.item.product.id)}}},[t._v("- ")]),e("button",{staticClass:"cart_button",on:{click:function(e){return t.cart.increase(t.item.product.id)}}},[t._v("+ ")]),e("div",{staticClass:"cart_body"},[e("div",[e("b",[t._v(t._s(t.item.quantite))]),t._v(" x "+t._s(t.item.product.nom)+" "),e("fa",{staticStyle:{color:"#b55"},attrs:{icon:"trash-alt"},on:{click:function(e){return t.remove(t.item)}}})],1),e("div",[e("b",[t._v(t._s(t.money(t.item.getTotal())))]),t._v(" Fbu ")])])])},ct=[],dt={props:{item:{type:Object,required:!0}},computed:{cart(){return this.$store.state.cart}},methods:{remove(t){let e=this.cart.find(t.product.id);this.cart.content.splice(e,1)}}},ht=dt,pt=(0,h.Z)(ht,ut,ct,!1,null,"a95cc038",null),mt=pt.exports,vt={components:{SearchBar:T,Item:lt,CartItem:mt,DialogSubmit:X},data(){return{items:this.$store.state.produits,cart:this.$store.state.cart,panier_shown:!0,confirm_vente:!1,to_search:""}},computed:{non_empty_items(){return this.items.filter((t=>t.quantite>0))},empty_items(){return this.items.filter((t=>0==t.quantite))}},methods:{performFilter(t){let e=this.$store.state.produits.filter((e=>e.id==t|e.nom.toLowerCase().includes(t.toLowerCase())));this.items=e},fetchProducts(){let t={headers:{Authorization:"Bearer "+this.$store.state.user.access}};n().get(this.$store.state.url+"/produit/",t).then((t=>{this.$store.state.produits=t.data.results,this.items=t.data.results})).catch((t=>{if("token_not_valid"==t.response.data.code){let t={refresh:this.$store.state.user.refresh};n().post(this.$store.state.url+"/refresh/",t).then((t=>{this.$store.state.user.access=t.data.access,this.fetchProducts()})).catch((t=>{this.$store.state.user=null}))}}))}},mounted(){this.$store.state.produits.length<1&&this.fetchProducts(),document.onkeydown=t=>{if("/home"!==location.pathname)return;this.to_search+=t.key;let e=setTimeout((()=>{for(let t of this.$store.state.produits)if(t.id==this.to_search){this.cart.add(t);break}clearTimeout(e),this.to_search=""}),200)}}},_t=vt,ft=(0,h.Z)(_t,et,st,!1,null,null,null),gt=ft.exports,bt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"parent"},[e("SearchBar",{attrs:{show_date:!1},on:{searched:t.performFilter}}),e("div",{staticClass:"page"},[e("div",{staticClass:"items"},[e("div",{staticClass:"recycler"},t._l(t.non_empty_items,(function(t){return e("Item",{key:t.id,attrs:{item:t}})})),1),e("hr",{staticStyle:{margin:"20px 0"}}),e("div",{staticClass:"recycler"},t._l(t.empty_items,(function(t){return e("Item",{key:t.id,attrs:{item:t}})})),1)]),t.panier_shown?e("div",{staticClass:"cart"},[e("span",{staticClass:"close_panier",on:{click:function(e){t.panier_shown=!1}}},[t._v("x")]),e("h3",{staticClass:"title"},[t._v("Panier")]),e("div",{staticClass:"panier_items"},t._l(t.cart.content,(function(t){return e("CartItem",{key:t.id,attrs:{item:t}})})),1),e("div",{staticClass:"totals"},[e("div",[t._v(" Total ")]),e("div",[e("b",[t._v(t._s(t.money(t.cart.getTotal())))]),t._v(" Fbu")])]),t.cart.getLength()?e("div",{staticClass:"cart_buttons"},[e("button",{on:{click:function(e){t.cart.content=[]}}},[t._v("reset")]),e("button",{on:{click:function(e){t.confirm_vente=!0}}},[t._v("valider")])]):t._e()]):e("div",{staticClass:"btn_panier",on:{click:function(e){t.panier_shown=!0}}},[t._v(" panier("+t._s(t.cart.getLength())+") ")])])],1)},yt=[],xt=function(){var t=this,e=t._self._c;return e("div",{class:{parent:!0,danger:0==t.item.quantite},attrs:{"data-id":t.item.id}},[e("div",{staticStyle:{"flex-grow":"1"}},[e("span",{staticClass:"name"},[t._v(" Salle "+t._s(t.item.nom))]),e("div",{staticClass:"prix"},[t._v(" "+t._s(t.money(t.item.prix.prix))+" Fbu")])]),e("div",{staticClass:"qtt"},[t._v(" quantité dispo: "),e("span",{staticClass:"dispo"},[t._v(" "+t._s(t.item.quantite)+" poulets ")])]),e("div",{staticClass:"buttons"},[e("button",{staticClass:"bg-blue",on:{click:t.decreaseQtt}},[t._v("-")]),t.editable?e("input",{directives:[{name:"model",rawName:"v-model",value:t.qtt,expression:"qtt"}],staticClass:"item_qtt",attrs:{type:"number",max:t.item.quantite},domProps:{value:t.qtt},on:{keydown:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.qtt=e.target.value)}}}):e("label",{on:{click:t.enableEdition}},[t._v(t._s(t.qtt))]),e("button",{staticClass:"bg-blue",on:{click:t.increaseQtt}},[t._v("+")])])])},$t=[],Ct={props:{item:{type:Object,required:!0}},data(){return{cart:this.$store.state.cart,editable:!1}},methods:{getIcon(t){return null==t.image?"/img/item.png":t.image},increaseQtt:function(){this.cart.add(this.item)},decreaseQtt:function(){this.cart.decrease(this.item.id)},enableEdition(){0!=this.item.quantite&&(this.editable=!0)}},computed:{qtt:{get(){return this.cart.getQuantite(this.item.id)},set(t){0!=t.length&&this.cart.add(this.item,t)}}}},wt=Ct,qt=(0,h.Z)(wt,xt,$t,!1,null,"116523f0",null),kt=qt.exports,Pt={components:{SearchBar:T,Item:kt,CartItem:mt,DialogSubmit:X},data(){return{items:this.$store.state.salles,cart:this.$store.state.cart,panier_shown:!0,confirm_vente:!1,to_search:""}},computed:{non_empty_items(){return this.items.filter((t=>t.quantite>0))},empty_items(){return this.items.filter((t=>0==t.quantite))}},methods:{performFilter(t){let e=this.$store.state.salles.filter((e=>e.id==t|e.nom.toLowerCase().includes(t.toLowerCase())));this.items=e},fetchProducts(){let t={headers:{Authorization:"Bearer "+this.$store.state.user.access}};n().get(this.$store.state.url+"/salle/",t).then((t=>{this.$store.state.salles=t.data.results,this.items=t.data.results})).catch((t=>{if("token_not_valid"==t.response.data.code){let t={refresh:this.$store.state.user.refresh};n().post(this.$store.state.url+"/refresh/",t).then((t=>{this.$store.state.user.access=t.data.access,this.fetchProducts()})).catch((t=>{this.$store.state.user=null}))}}))}},mounted(){this.$store.state.salles.length<1&&this.fetchProducts(),document.onkeydown=t=>{if("/home/ration"!==location.pathname)return;this.to_search+=t.key;let e=setTimeout((()=>{for(let t of this.$store.state.salles)if(t.id==this.to_search){this.cart.add(t);break}clearTimeout(e),this.to_search=""}),200)}}},Dt=Pt,St=(0,h.Z)(Dt,bt,yt,!1,null,null,null),Bt=(St.exports,function(){var t=this,e=t._self._c;return e("div",{staticClass:"parent"},[e("div",{staticClass:"top"},[e("SearchBar",{attrs:{show_date:!1},on:{searched:t.performFilter}})],1),e("div",{staticClass:"scrollable-tab"},[e("table",{staticClass:"table paiements"},[e("thead",[e("tr",{staticClass:"panier-item"},[e("th",[t._v("#")]),e("th",[t._v("nom")]),e("th",[t._v("quantite")]),e("th",[t._v("date")]),e("th",[t._v("prix d'achat")]),e("th",[t._v("prix d'achat Total")]),e("th",[e("button",{on:{click:function(e){t.add_mode=!0}}},[t._v("Ajouter")])])])]),e("tbody",{attrs:{id:"paiements"}},t._l(t.items,(function(s,a){return e("tr",{class:t.level(s.quantite)},[e("th",[t._v(t._s(a+1))]),e("td",[t._v(t._s(s.nom))]),e("td",[t._v(t._s(s.quantite)+" "+t._s(s.unite))]),e("td",[t._v(t._s(t.datetime(s.date)))]),e("td",[t._v(t._s(t.money(s.prix_unitaire))+" Fbu")]),e("td",[t._v(t._s(t.money(s.prix_unitaire*s.quantite))+" Fbu")]),e("td",[e("div",{staticClass:"btns"},[e("button",{on:{click:function(e){return e.preventDefault(),t.startEdit(s)}}},[t._v("Edit")]),e("button",{on:{click:function(e){return e.preventDefault(),t.startAchat(s)}}},[t._v("Acheter")])])])])})),0),e("tfoot",[e("tr",{staticClass:"panier-item"},[e("th",{attrs:{colspan:"5"}},[t._v("total")]),e("th",[t._v(t._s(t.money(t.total()))+" Fbu")]),e("th",{attrs:{colspan:"2"}})])])])]),e("EditDialog",{attrs:{visible:t.edit_mode,produit:t.active_item},on:{close:t.exitEdition}}),e("AchatDialog",{attrs:{visible:t.achat_mode,produit:t.active_item},on:{close:t.exitEdition}}),e("ProduitDialog",{attrs:{visible:t.add_mode},on:{close:t.exitEdition}})],1)}),At=[],Nt=(s(7658),function(){var t=this,e=t._self._c;return e("div",{class:{popup:!0,active:t.visible},on:{click:t.close}},[e("div",{staticClass:"popup-body",on:{click:function(t){t.preventDefault(),t.stopPropagation()}}},[e("center",[e("h3",[t._v("Oeuf pondu dans salle "+t._s(t.salle.nom))])]),e("form",{attrs:{method:"post"}},[e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_prix"}},[t._v("Quantite:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.lg_qtt,expression:"lg_qtt"}],attrs:{type:"text",name:"prix"},domProps:{value:t.lg_qtt},on:{input:function(e){e.target.composing||(t.lg_qtt=e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_prix"}},[t._v("Commentaire:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.commentaire,expression:"commentaire"}],attrs:{type:"text",name:"prix"},domProps:{value:t.commentaire},on:{input:function(e){e.target.composing||(t.commentaire=e.target.value)}}})]),e("div",{staticClass:"buttons"},[e("div",{staticClass:"logs"},[t._v(t._s(t.logs))]),e("input",{attrs:{type:"submit",value:"submit"},on:{click:t.performAchat}})])])],1)])}),Tt=[],Ot={props:{visible:{type:Boolean,default:!1},salle:{type:Object,required:!0},achat:{type:Object,required:!1}},data(){return{payee:0,lg_qtt:0,total:0,logs:"",sm_qtt:0,prix:0,commentaire:"",quantite:0}},computed:{qttTotal(){return this.lg_qtt},headers(){return{headers:{Authorization:"Bearer "+this.$store.state.user.access}}}},watch:{prix(t){this.$refs.prix==document.activeElement&&(this.total=t*this.qttTotal)},total(t){this.$refs.total==document.activeElement&&(this.prix=t/this.qttTotal)},achat(t){console.log(t),1==this.salle.rapport?this.lg_qtt=t.quantite:this.sm_qtt=t.quantite,this.total=t.prix_total}},methods:{close(){this.lg_qtt=0,this.sm_qtt=0,this.$emit("close")},performAchat(){let t={quantite:this.qttTotal,commentaire:this.commentaire,salle:this.salle.id},e=this.$store.state.url;n().post(e+"/oeuf/",t,this.headers).then((t=>{let e=this.$store.state.salles,s=e.find((t=>t.id==this.salle.id));this.$store.state.oeufs.unshift(t.data),s?(s.quantite_oeuf+=t.data.quantite,this.$emit("close")):this.logs="quelque chose a mal tourné"})).catch((t=>{t.response?this.logs=t.response.data.status:this.logs="une erreur est survenue"}))},performEdition(){let t={quantite:this.qttTotal,details:this.details,prix_total:this.total,salle:this.salle.id},e=this.$store.state.url;n().put(e+`/achat/${this.achat.id}/`,t,this.headers).then((t=>{this.salle.quantite-=this.achat.quantite,this.achat.quantite=t.data.quantite,this.salle.quantite+=t.data.quantite,this.achat.prix_total=t.data.prix_total,this.achat.prix_unitaire=t.data.prix_unitaire,this.$emit("close")})).catch((t=>{t.response?this.logs=t.response.data.status:this.logs="une erreur est survenue"}))}}},Lt=Ot,It=(0,h.Z)(Lt,Nt,Tt,!1,null,"66d350fe",null),Et=It.exports,Ft=function(){var t=this,e=t._self._c;return e("div",{class:{popup:!0,active:t.visible},on:{click:t.close}},[e("div",{staticClass:"popup-body",on:{click:function(t){t.preventDefault(),t.stopPropagation()}}},[e("center",[e("h3",[t._v("Modifier "+t._s(t.produit.nom))])]),e("form",{attrs:{method:"post"}},[e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_unite"}},[t._v("Nom:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.new_produit.nom,expression:"new_produit.nom"}],attrs:{type:"text",id:"id_unite"},domProps:{value:t.new_produit.nom},on:{input:function(e){e.target.composing||t.$set(t.new_produit,"nom",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_unite"}},[t._v("Unite d'achat:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.new_produit.unite,expression:"new_produit.unite"}],attrs:{type:"text",id:"id_unite"},domProps:{value:t.new_produit.unite},on:{input:function(e){e.target.composing||t.$set(t.new_produit,"unite",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_prix"}},[t._v("Nouveau prix:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.new_produit.prix_unitaire,expression:"new_produit.prix_unitaire"}],attrs:{type:"number",name:"prix",placeholder:"prix",required:"",id:"id_quantite"},domProps:{value:t.new_produit.prix_unitaire},on:{input:function(e){e.target.composing||t.$set(t.new_produit,"prix_unitaire",e.target.value)}}})]),e("div",{staticClass:"buttons"},[e("div",{staticClass:"logs"},[t._v(t._s(t.logs))]),e("input",{attrs:{type:"submit",value:"Modifier"},on:{click:t.changerPrix}})])])],1)])},zt=[],Zt={props:{visible:{type:Boolean,default:!1},produit:{type:Object,required:!0}},data(){return{logs:"",new_price:"",new_produit:""}},watch:{produit(t){this.new_produit=JSON.parse(JSON.stringify(t))}},methods:{close(){this.$emit("close")},changerPrix(){let t={headers:{Authorization:"Bearer "+this.$store.state.user.access}};n().put(this.$store.state.url+`/produit/${this.produit.id}/`,this.new_produit,t).then((t=>{let e=this.$store.state.produits;for(var s=0;s<e.length;s++){let a=e[s];if(a.id==this.produit.id){this.$store.state.produits[s]=t.data;break}}this.$emit("close")})).catch((t=>{console.error(t)}))}}},jt=Zt,Ut=(0,h.Z)(jt,Ft,zt,!1,null,"72f8f61c",null),Vt=Ut.exports,Rt=function(){var t=this,e=t._self._c;return e("div",{class:{popup:!0,active:t.visible},on:{click:t.close}},[e("div",{ref:"modal",staticClass:"popup-body",on:{click:function(t){t.stopPropagation()}}},[e("center",[e("h3",[t._v("Ajouter un Produit")])]),e("form",{attrs:{method:"post"}},[e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_nom"}},[t._v("Nom:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.produit.nom,expression:"produit.nom"}],attrs:{type:"text",id:"id_nom",placeholder:"le nom du produit"},domProps:{value:t.produit.nom},on:{input:function(e){e.target.composing||t.$set(t.produit,"nom",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_entrant"}},[t._v("Unité d'achat:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.produit.unite,expression:"produit.unite"}],attrs:{type:"text",id:"id_entrant",placeholder:"exemples: kg,carton,casier..."},domProps:{value:t.produit.unite},on:{input:function(e){e.target.composing||t.$set(t.produit,"unite",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_prix"}},[t._v("Prix:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.produit.prix_unitaire,expression:"produit.prix_unitaire"}],attrs:{type:"number",name:"prix",placeholder:"prix unitaire",id:"id_prix"},domProps:{value:t.produit.prix_unitaire},on:{input:function(e){e.target.composing||t.$set(t.produit,"prix_unitaire",e.target.value)}}})]),e("div",{staticClass:"logs"},[t._v(t._s(t.logs))]),e("div",{staticClass:"buttons"},[e("button",{ref:"submit",on:{click:function(e){return e.preventDefault(),t.createProduct.apply(null,arguments)}}},[t._v(" Créer ")])])])],1)])},Qt=[],Jt={props:{visible:{type:Boolean,default:!1},modelaVisible:!0},data(){return{logs:"",produit:{},new_price:"",csv_array:[],csvData:{size:0,fileData:[]}}},watch:{csv_array(t){if(0==t.length)return this.logs="",void(this.$refs.submit.innerText="Créer");this.logs=t.length+" produits chargés",this.$refs.submit.innerText="upload"}},computed:{rapport(){let t="1 "+this.produit.unite+" vaut combien de "+this.produit.unite_sortant+"?";return this.produit.unite_sortant?t:"1 par defaut"},unite_sortant(){return this.produit.unite?this.produit.unite+" par defaut":"exemples: kg,carton,casier..."},headers(){return{headers:{Authorization:"Bearer "+this.$store.state.user.access}}}},methods:{close(){this.$emit("close")},uploadCSV(){n().post(this.$store.state.url+"/produit/",this.csv_array,this.headers).then((t=>{this.$store.state.produits=this.$store.state.produits.concat(t.data),this.csv_array=[],this.close()})).catch((t=>{console.error(t)}))},createProduct(){this.csv_array.length>0?this.uploadCSV():this.produit.nom?this.produit.unite?(this.produit.prix_achat||(this.produit.prix_achat=0,this.logs=""),n().post(this.$store.state.url+"/produit/",this.produit,this.headers).then((t=>{this.produit={},this.$store.state.produits.push(t.data),this.$emit("close")})).catch((t=>{console.error(t)}))):this.logs="l'unité d'achat est obligatoire":this.logs="le nom est obligatoire"},download(t){const e=new Blob([t],{type:"text/csv"}),s=window.URL.createObjectURL(e),a=document.createElement("a");a.setAttribute("hidden",""),a.setAttribute("href",s),a.setAttribute("download","model.csv"),document.body.appendChild(a),a.click(),document.body.removeChild(a)},generateCSV(){let t='"sep=;"\nnom;unite;unite_sortant;rapport;prix_vente\n';this.download(t)},onPickFile(){this.$refs.fileInput.click()},loadCSV(t){if(t.target.files&&t.target.files[0]){let e=new FileReader;e.readAsBinaryString(t.target.files[0]),e.onload=t=>{this.csvData.size=t.total,this.csvData.fileData=t.target.result;let e=this.convertToJSON(this.csvData.fileData);this.csv_array=e}}},convertToJSON(t){let e=t.trim().split("\n"),s=[],a=e[0].trim().split(";"),i=[],r={};e=e.slice(1);for(let o=0;o<e.length;o++){i=e[o].trim().split(";");for(let t=0;t<i.length;t++)r[a[t]]=i[t];s.push(r),r={}}return s}}},Mt=Jt,Gt=(0,h.Z)(Mt,Rt,Qt,!1,null,"0176c84a",null),Ht=Gt.exports,Kt=function(){var t=this,e=t._self._c;return e("div",{class:{popup:!0,active:t.visible},on:{click:t.close}},[e("div",{staticClass:"popup-body",on:{click:function(t){t.preventDefault(),t.stopPropagation()}}},[e("center",[e("h3",[t._v("Augmenter "+t._s(t.produit.nom))])]),e("form",{attrs:{method:"post"}},[e("div",{staticClass:"inline_field"},[e("div",{staticClass:"field"},[e("label",{attrs:{for:"lg_qtt"}},[t._v(t._s(t.produit.unite))]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.lg_qtt,expression:"lg_qtt"}],attrs:{type:"number",id:"lg_qtt"},domProps:{value:t.lg_qtt},on:{input:function(e){e.target.composing||(t.lg_qtt=e.target.value)}}})])]),e("div",{class:{inline_field:1!=t.produit.rapport}},[e("div",{staticClass:"field"},[e("label",{attrs:{for:"prix"}},[t._v("Prix unitaire")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.prix,expression:"prix"}],ref:"prix",attrs:{type:"number",id:"prix"},domProps:{value:t.prix},on:{input:function(e){e.target.composing||(t.prix=e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"total"}},[t._v("Prix total")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.total,expression:"total"}],ref:"total",attrs:{type:"number",id:"total"},domProps:{value:t.total},on:{input:function(e){e.target.composing||(t.total=e.target.value)}}})])]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_prix"}},[t._v("Details:")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.details,expression:"details"}],attrs:{name:"prix"},domProps:{value:t.details},on:{input:function(e){e.target.composing||(t.details=e.target.value)}}})]),e("div",{staticClass:"buttons"},[e("div",{staticClass:"logs"},[t._v(t._s(t.logs))]),e("input",{attrs:{type:"submit",value:"submit"},on:{click:t.submit}})])])],1)])},Xt=[],Wt={props:{visible:{type:Boolean,default:!1},produit:{type:Object,required:!0},achat:{type:Object,required:!1}},data(){return{payee:0,lg_qtt:0,total:0,logs:"",sm_qtt:0,prix:0,details:""}},computed:{qttTotal(){return this.lg_qtt},headers(){return{headers:{Authorization:"Bearer "+this.$store.state.user.access}}}},watch:{prix(t){this.$refs.prix==document.activeElement&&(this.total=t*this.qttTotal)},total(t){this.$refs.total==document.activeElement&&(this.prix=t/this.qttTotal)},achat(t){console.log(t),1==this.produit.rapport?this.lg_qtt=t.quantite:this.sm_qtt=t.quantite,this.total=t.prix_total}},methods:{close(){this.lg_qtt=0,this.sm_qtt=0,this.$emit("close")},submit(){this.achat?this.performEdition():this.performAchat()},performAchat(){let t={quantite:this.qttTotal,details:this.details,prix_total:this.total,produit:this.produit.id},e=this.$store.state.url;n().post(e+"/achat/",t,this.headers).then((t=>{let e=this.$store.state.produits,s=e.find((t=>t.id==this.produit.id));this.$store.state.achats.unshift(t.data),s?(s.quantite+=t.data.quantite,this.$emit("close")):this.logs="quelque chose a mal tourné"})).catch((t=>{t.response?this.logs=t.response.data.status:this.logs="une erreur est survenue"}))},performEdition(){let t={quantite:this.qttTotal,details:this.details,prix_total:this.total,produit:this.produit.id},e=this.$store.state.url;n().put(e+`/achat/${this.achat.id}/`,t,this.headers).then((t=>{this.produit.quantite-=this.achat.quantite,this.achat.quantite=t.data.quantite,this.produit.quantite+=t.data.quantite,this.achat.prix_total=t.data.prix_total,this.achat.prix_unitaire=t.data.prix_unitaire,this.$emit("close")})).catch((t=>{t.response?this.logs=t.response.data.status:this.logs="une erreur est survenue"}))}}},Yt=Wt,te=(0,h.Z)(Yt,Kt,Xt,!1,null,"2242b7c2",null),ee=te.exports,se={components:{SearchBar:T,Item:Et,EditDialog:Vt,AchatDialog:ee,ProduitDialog:Ht},data(){return{csvData:{},items:this.$store.state.produits,active_item:{},edit_mode:!1,achat_mode:!1,add_mode:!1}},watch:{"$store.state.produits"(t){this.items=t}},methods:{fetchData(){let t={headers:{Authorization:"Bearer "+this.$store.state.user.access}};0==this.$store.state.users.length&&n().get(this.$store.state.url+"/produit/",t).then((t=>{this.$store.state.produits=t.data.results,this.items=t.data.results,console.log(t.data.results)})).catch((t=>{t.response||console.error(t)}))},total(){let t=0;for(let e of this.items)t+=e.prix_unitaire*e.quantite;return t},exitEdition(){this.active_item={},this.edit_mode=!1,this.achat_mode=!1,this.add_mode=!1},startEdit(t){this.active_item=t,this.edit_mode=!0},startAchat(t){this.active_item=t,this.achat_mode=!0},performFilter(t){let e=this.$store.state.produits.filter((e=>e.id==t|e.nom.toLowerCase().includes(t.toLowerCase())));this.items=e},download(t){const e=new Blob([t],{type:"text/csv"}),s=window.URL.createObjectURL(e),a=document.createElement("a");a.setAttribute("hidden",""),a.setAttribute("href",s),a.setAttribute("download","model.csv"),document.body.appendChild(a),a.click(),document.body.removeChild(a)},generateCSV(){let t=this.items,e="id;produit;quantite;prix_achat;details\n";for(var s=0;s<t.length;s++)e+=t[s].id+";"+t[s].nom+"\n";console.log(e),this.download(e)},level(t){return 0==t?"empty":t<=5?"low":void 0},onPickFile(){this.$refs.fileInput.click()},uploadCSV(t){if(t.target.files&&t.target.files[0]){let e=new FileReader;e.readAsBinaryString(t.target.files[0]),e.onload=t=>{console.log(t),this.csvData.size=t.total,this.csvData.fileData=t.target.result;let e=this.convertToJSON(this.csvData.fileData);console.log(e),console.table(e)}}},convertToJSON(t){let e=t.trim().split("\n"),s=[],a=e[0].split(";"),i=[],r={};e=e.slice(1);for(let o=0;o<e.length;o++){i=e[o].split(";");for(let t=0;t<i.length;t++)if(0===i.indexOf(i[t])||isNaN(i[t]))r[a[t]]=i[t];else{let e=Number.parseFloat(i[t]);r[a[t]]=e.toFixed(2)}s.push(r),r={}}return s}},mounted(){this.fetchData()}},ae=se,ie=(0,h.Z)(ae,Bt,At,!1,null,"85a43660",null),re=ie.exports,oe=function(){var t=this,e=t._self._c;return e("div",{staticClass:"parent"},[e("div",{staticClass:"top"},[e("br"),e("SearchBar",{attrs:{show_date:!1},on:{searched:t.performFilter}})],1),e("br"),e("div",{staticClass:"recycler"}),e("div",{staticClass:"scrollable-tab"},[e("table",{staticClass:"table paiements"},[e("thead",[e("tr",{staticClass:"panier-item",staticStyle:{"text-transform":"capitalize"}},[e("th",[t._v("#")]),e("th",[t._v("Salle")]),e("th",[t._v("Type de poulle")]),e("th",[t._v("responsable")]),e("th",[t._v("Telephone")]),e("th",[t._v("quantite")]),e("th",[t._v("date")]),e("th",[e("button",{on:{click:function(e){t.add_mode=!0}}},[t._v("Ajouter")])])])]),e("tbody",{attrs:{id:"paiements"}},t._l(t.items,(function(s,a){return e("tr",[e("th",[t._v(t._s(a+1))]),e("td",[t._v(t._s(s.nom))]),e("td",[t._v(t._s(s.type_poulle)+" ")]),e("td",[t._v(t._s(s.responsable.nom)+" "+t._s(s.responsable.prenom))]),e("td",[t._v(t._s(s.responsable.telephone)+" ")]),e("td",[t._v(t._s(s.quantite)+" poulles")]),e("td",[t._v(t._s(t.datetime(s.date)))]),e("td",[e("div",{staticClass:"btns"},[e("button",{on:{click:function(e){return e.preventDefault(),t.startEdit(s)}}},[t._v("Edit")]),"poulet pondeuse"==s.type_poulle?e("button",{staticStyle:{"background-color":"yellow",color:"#000"},on:{click:function(e){return e.preventDefault(),t.startAchat(s)}}},[t._v("Oeuf")]):t._e(),"poulet en chair"==s.type_poulle?e("button",{staticStyle:{"background-color":"teal"},on:{click:function(e){return e.preventDefault(),t.startVente(s)}}},[t._v("Vendre")]):t._e()])])])})),0),e("tfoot",[e("tr",{staticClass:"panier-item"},[e("th",{attrs:{colspan:"5"}},[t._v("Total")]),e("th",[t._v(t._s(t.money(t.total()))+" poulles")]),e("th",{attrs:{colspan:"2"}})])])])]),e("EditDialog",{attrs:{visible:t.edit_mode,produit:t.active_item},on:{close:t.exitEdition}}),e("AchatDialog",{attrs:{visible:t.achat_mode,salle:t.active_item},on:{close:t.exitEdition}}),e("VenteDialog",{attrs:{visible:t.achat_mod,salle:t.active_item},on:{close:t.exitEdition}}),e("ProduitDialog",{attrs:{visible:t.add_mode},on:{close:t.exitEdition}})],1)},ne=[],le=function(){var t=this,e=t._self._c;return e("div",{class:{popup:!0,active:t.visible},on:{click:t.close}},[e("div",{staticClass:"popup-body",on:{click:function(t){t.preventDefault(),t.stopPropagation()}}},[e("center",[e("h3",[t._v("Modifier "+t._s(t.produit.nom))])]),e("form",{attrs:{method:"post"}},[e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_unite"}},[t._v("Nom:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.new_produit.nom,expression:"new_produit.nom"}],attrs:{type:"text",id:"id_unite"},domProps:{value:t.new_produit.nom},on:{input:function(e){e.target.composing||t.$set(t.new_produit,"nom",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_unite"}},[t._v("Quantite:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.new_produit.quantite,expression:"new_produit.quantite"}],attrs:{type:"text",id:"id_unite"},domProps:{value:t.new_produit.quantite},on:{input:function(e){e.target.composing||t.$set(t.new_produit,"quantite",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_unite"}},[t._v("Type de poule:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.new_produit.type_poulle,expression:"new_produit.type_poulle"}],attrs:{type:"text",id:"id_unite"},domProps:{value:t.new_produit.type_poulle},on:{input:function(e){e.target.composing||t.$set(t.new_produit,"type_poulle",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_prix"}},[t._v("Responsable:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.new_produit.responsable,expression:"new_produit.responsable"}],attrs:{type:"number",name:"prix",required:"",id:"id_quantite"},domProps:{value:t.new_produit.responsable},on:{input:function(e){e.target.composing||t.$set(t.new_produit,"responsable",e.target.value)}}})]),e("div",{staticClass:"buttons"},[e("div",{staticClass:"logs"},[t._v(t._s(t.logs))]),e("input",{attrs:{type:"submit",value:"Modifier"},on:{click:t.changerSalle}})])])],1)])},ue=[],ce={props:{visible:{type:Boolean,default:!1},produit:{type:Object,required:!0}},data(){return{logs:"",new_price:"",new_produit:""}},watch:{produit(t){this.new_produit=JSON.parse(JSON.stringify(t))}},methods:{close(){this.$emit("close")},changerSalle(){let t={headers:{Authorization:"Bearer "+this.$store.state.user.access}};n().put(this.$store.state.url+`/salle/${this.produit.id}/`,this.new_produit,t).then((t=>{let e=this.$store.state.salles;for(var s=0;s<e.length;s++){let a=e[s];if(a.id==this.produit.id){this.$store.state.salles[s]=t.data;break}}this.$emit("close")})).catch((t=>{console.error(t)}))}}},de=ce,he=(0,h.Z)(de,le,ue,!1,null,"704a0ee8",null),pe=he.exports,me=function(){var t=this,e=t._self._c;return e("div",{class:{popup:!0,active:t.visible},on:{click:t.close}},[e("div",{ref:"modal",staticClass:"popup-body",on:{click:function(t){t.stopPropagation()}}},[e("center",[e("h3",[t._v("Ajouter une Salle")])]),e("form",{attrs:{method:"post"}},[e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_nom"}},[t._v("Nom:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.salle.nom,expression:"salle.nom"}],attrs:{type:"text",id:"id_nom",placeholder:"le nom du salle"},domProps:{value:t.salle.nom},on:{input:function(e){e.target.composing||t.$set(t.salle,"nom",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",[t._v("Selectionnez le type de poulle")]),e("br"),e("select",{directives:[{name:"model",rawName:"v-model",value:t.salle.type_poulle,expression:"salle.type_poulle"}],attrs:{type:"text",name:"cars_id",id:"id_entrant"},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.salle,"type_poulle",e.target.multiple?s:s[0])}}},[e("option",[t._v("---- Selection d'une type ----")]),e("option",{attrs:{value:"poulet pondeuse"}},[t._v("Poulet pondeuse")]),e("option",{attrs:{value:"poulet en chair"}},[t._v("Poulet en chair")])])]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_nom"}},[t._v("Quantite:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.salle.quantite,expression:"salle.quantite"}],attrs:{type:"text",id:"id_nom",placeholder:"le nombre de poulles"},domProps:{value:t.salle.quantite},on:{input:function(e){e.target.composing||t.$set(t.salle,"quantite",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_nom"}},[t._v("Nom du responsable")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.responsable.nom,expression:"responsable.nom"}],attrs:{type:"text",list:"noms",id:"id_nom"},domProps:{value:t.responsable.nom},on:{change:t.setTel,input:function(e){e.target.composing||t.$set(t.responsable,"nom",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_tel"}},[t._v("Téléphone")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.responsable.telephone,expression:"responsable.telephone"}],attrs:{type:"text",id:"id_tel",list:"tels"},domProps:{value:t.responsable.telephone},on:{change:t.setNom,input:function(e){e.target.composing||t.$set(t.responsable,"telephone",e.target.value)}}})]),e("div",{staticClass:"logs"},[t._v(t._s(t.logs))]),e("div",{staticStyle:{float:"right"}},[e("button",{ref:"submit",on:{click:function(e){return e.preventDefault(),t.createProduct.apply(null,arguments)}}},[t._v(" Créer ")])])]),e("datalist",{attrs:{id:"noms"}},t._l(t.responsables,(function(t){return e("option",{domProps:{value:t.nom}})})),0),e("datalist",{attrs:{id:"tels"}},t._l(t.responsables,(function(t){return e("option",{domProps:{value:t.tel}})})),0)],1)])},ve=[],_e={props:{visible:{type:Boolean,default:!1},modelaVisible:!0},data(){return{logs:"",salle:{nom:"",type_poulle:"",quantite:0},selectedId:null,responsable:{nom:"",telephone:""},new_price:"",csv_array:[],csvData:{size:0,fileData:[]}}},watch:{csv_array(t){if(0==t.length)return this.logs="",void(this.$refs.submit.innerText="Créer");this.logs=t.length+" produits chargés",this.$refs.submit.innerText="upload"}},computed:{responsables(){return this.$store.state.responsables},host(){return this.$store.state.url},username(){return this.$store.state.user.username},headers(){return{headers:{Authorization:"Bearer "+this.$store.state.user.access}}}},mounted(){this.responsables.length<1&&n().get(this.$store.state.url+"/responsable/",this.headers).then((t=>{this.$store.state.responsables=t.data.results})).catch((t=>{}))},methods:{close(){this.$emit("close")},setTel(){for(let t of this.responsables)if(t.nom==this.responsable.nom)return void(this.responsable.telephone=t.telephone)},setNom(){for(let t of this.responsables)if(t.telephone==this.responsable.telephone)return void(this.responsable.nom=t.nom)},createProduct(){n().post(this.$store.state.url+"/salle/",{responsable:this.responsable,nom:this.salle.nom,type_poulle:this.salle.type_poulle,quantite:this.salle.quantite},this.headers).then((t=>{this.$store.state.salles.push(t.data),this.$emit("close")})).catch((t=>{console.error(t)}))}}},fe=_e,ge=(0,h.Z)(fe,me,ve,!1,null,"47037f84",null),be=ge.exports,ye=function(){var t=this,e=t._self._c;return e("div",{class:{popup:!0,active:t.visible},on:{click:t.close}},[e("div",{staticClass:"popup-body",on:{click:function(t){t.preventDefault(),t.stopPropagation()}}},[e("center",[e("h3",[t._v("Oeuf pondu dans salle "+t._s(t.salle.nom))])]),e("form",{attrs:{method:"post"}},[e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_prix"}},[t._v("Quantite:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.lg_qtt,expression:"lg_qtt"}],attrs:{type:"text",name:"prix"},domProps:{value:t.lg_qtt},on:{input:function(e){e.target.composing||(t.lg_qtt=e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_prix"}},[t._v("Commentaire:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.commentaire,expression:"commentaire"}],attrs:{type:"text",name:"prix"},domProps:{value:t.commentaire},on:{input:function(e){e.target.composing||(t.commentaire=e.target.value)}}})]),e("div",{staticClass:"buttons"},[e("div",{staticClass:"logs"},[t._v(t._s(t.logs))]),e("input",{attrs:{type:"submit",value:"submit"},on:{click:t.performAchat}})])])],1)])},xe=[],$e={props:{visible:{type:Boolean,default:!1},salle:{type:Object,required:!0},achat:{type:Object,required:!1}},data(){return{payee:0,lg_qtt:0,total:0,logs:"",sm_qtt:0,prix:0,commentaire:"",quantite:0}},computed:{qttTotal(){return this.lg_qtt},headers(){return{headers:{Authorization:"Bearer "+this.$store.state.user.access}}}},watch:{prix(t){this.$refs.prix==document.activeElement&&(this.total=t*this.qttTotal)},total(t){this.$refs.total==document.activeElement&&(this.prix=t/this.qttTotal)},achat(t){console.log(t),1==this.salle.rapport?this.lg_qtt=t.quantite:this.sm_qtt=t.quantite,this.total=t.prix_total}},methods:{close(){this.lg_qtt=0,this.sm_qtt=0,this.$emit("close")},performAchat(){let t={quantite:this.qttTotal,commentaire:this.commentaire,salle:this.salle.id},e=this.$store.state.url;n().post(e+"/oeuf/",t,this.headers).then((t=>{let e=this.$store.state.salles,s=e.find((t=>t.id==this.salle.id));this.$store.state.oeufs.unshift(t.data),s?(s.quantite_oeuf+=t.data.quantite,this.$emit("close")):this.logs="quelque chose a mal tourné"})).catch((t=>{t.response?this.logs=t.response.data.status:this.logs="une erreur est survenue"}))},performEdition(){let t={quantite:this.qttTotal,details:this.details,prix_total:this.total,salle:this.salle.id},e=this.$store.state.url;n().put(e+`/achat/${this.achat.id}/`,t,this.headers).then((t=>{this.salle.quantite-=this.achat.quantite,this.achat.quantite=t.data.quantite,this.salle.quantite+=t.data.quantite,this.achat.prix_total=t.data.prix_total,this.achat.prix_unitaire=t.data.prix_unitaire,this.$emit("close")})).catch((t=>{t.response?this.logs=t.response.data.status:this.logs="une erreur est survenue"}))}}},Ce=$e,we=(0,h.Z)(Ce,ye,xe,!1,null,"a9c64ba8",null),qe=we.exports,ke=function(){var t=this,e=t._self._c;return e("div",{class:{popup:!0,active:t.visible},on:{click:t.close}},[e("div",{staticClass:"popup-body",on:{click:function(t){t.preventDefault(),t.stopPropagation()}}},[e("center",[e("h3",[t._v("Poulet vendu dans salle "+t._s(t.salle.nom))])]),e("form",{attrs:{method:"post"}},[e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_prix"}},[t._v("Quantite:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.poulet.quantite,expression:"poulet.quantite"}],attrs:{type:"text",placeholder:"quantite de poulet",name:"prix"},domProps:{value:t.poulet.quantite},on:{input:function(e){e.target.composing||t.$set(t.poulet,"quantite",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_prix"}},[t._v("Poids:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.poulet.poids,expression:"poulet.poids"}],attrs:{type:"text",name:"prix",placeholder:"poids en kg"},domProps:{value:t.poulet.poids},on:{input:function(e){e.target.composing||t.$set(t.poulet,"poids",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_prix"}},[t._v("Prix:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.poulet.prix_unitaire,expression:"poulet.prix_unitaire"}],attrs:{type:"text",placeholder:"prix unitaire",name:"prix"},domProps:{value:t.poulet.prix_unitaire},on:{input:function(e){e.target.composing||t.$set(t.poulet,"prix_unitaire",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_nom"}},[t._v("Nom du client")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.client.nom,expression:"client.nom"}],attrs:{type:"text",list:"noms",placeholder:"nom du client",id:"id_nom"},domProps:{value:t.client.nom},on:{change:t.setTel,input:function(e){e.target.composing||t.$set(t.client,"nom",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_tel"}},[t._v("Téléphone")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.client.tel,expression:"client.tel"}],attrs:{type:"text",id:"id_tel",placeholder:"telephone du client",list:"tels"},domProps:{value:t.client.tel},on:{change:t.setNom,input:function(e){e.target.composing||t.$set(t.client,"tel",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_prix"}},[t._v("Details:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.poulet.commentaire,expression:"poulet.commentaire"}],attrs:{type:"text",name:"prix",placeholder:"commentaire"},domProps:{value:t.poulet.commentaire},on:{input:function(e){e.target.composing||t.$set(t.poulet,"commentaire",e.target.value)}}})]),e("div",{staticClass:"buttons"},[e("div",{staticClass:"logs"},[t._v(t._s(t.logs))]),e("input",{attrs:{type:"submit",value:"submit"},on:{click:t.performAchat}})])]),e("datalist",{attrs:{id:"noms"}},t._l(t.clients,(function(t){return e("option",{domProps:{value:t.nom}})})),0),e("datalist",{attrs:{id:"tels"}},t._l(t.clients,(function(t){return e("option",{domProps:{value:t.tel}})})),0)],1)])},Pe=[],De={props:{visible:{type:Boolean,default:!1},salle:{type:Object,required:!0},achat:{type:Object,required:!1}},data(){return{poulet:{},client:{nom:"",tel:""},payee:0,lg_qtt:0,total:0,logs:"",sm_qtt:0,prix:0,commentaire:"",quantite:0}},computed:{clients(){return this.$store.state.clients},qttTotal(){return this.lg_qtt},headers(){return{headers:{Authorization:"Bearer "+this.$store.state.user.access}}}},mounted(){n().get(this.$store.state.url+"/client/",this.headers).then((t=>{this.$store.state.clients=t.data.results})).catch((t=>{}))},watch:{prix(t){this.$refs.prix==document.activeElement&&(this.total=t*this.qttTotal)},total(t){this.$refs.total==document.activeElement&&(this.prix=t/this.qttTotal)},achat(t){console.log(t),1==this.salle.rapport?this.lg_qtt=t.quantite:this.sm_qtt=t.quantite,this.total=t.prix_total}},methods:{setTel(){for(let t of this.clients)if(t.nom==this.client.nom)return void(this.client.tel=t.tel)},setNom(){for(let t of this.clients)if(t.tel==this.client.tel)return void(this.client.nom=t.nom)},close(){this.lg_qtt=0,this.sm_qtt=0,this.$emit("close")},performAchat(){let t={quantite:this.poulet.quantite,poids:this.poulet.poids,prix_unitaire:this.poulet.prix_unitaire,commentaire:this.poulet.commentaire,salle:this.salle.id,client:this.client},e=this.$store.state.url;n().post(e+"/poulle_vendu/",t,this.headers).then((t=>{let e=this.$store.state.salles,s=e.find((t=>t.id==this.salle.id));this.$store.state.oeufs.unshift(t.data),s?(s.quantite-=t.data.quantite,this.$emit("close")):this.logs="quelque chose a mal tourné"})).catch((t=>{t.response?this.logs=t.response.data.status:this.logs="une erreur est survenue"}))}}},Se=De,Be=(0,h.Z)(Se,ke,Pe,!1,null,"90eea82a",null),Ae=Be.exports,Ne={components:{SearchBar:T,Item:Et,EditDialog:pe,AchatDialog:qe,ProduitDialog:be,VenteDialog:Ae},data(){return{csvData:{},items:this.$store.state.salles,active_item:{},edit_mode:!1,achat_mode:!1,add_mode:!1,achat_mod:!1}},watch:{"$store.state.salles"(t){this.items=t}},methods:{fetchData(){let t={headers:{Authorization:"Bearer "+this.$store.state.user.access}};0==this.$store.state.users.length&&n().get(this.$store.state.url+"/salle/",t).then((t=>{this.$store.state.salles=t.data.results,this.items=t.data.results,console.log(t.data.results)})).catch((t=>{t.response||console.error(t)}))},total(){let t=0;for(let e of this.items)t+=e.quantite;return t},totale(){let t=0;for(let e of this.items)t+=e.quantite_oeuf;return t},exitEdition(){this.active_item={},this.edit_mode=!1,this.achat_mode=!1,this.achat_mod=!1,this.add_mode=!1},startEdit(t){this.active_item=t,this.edit_mode=!0},startAchat(t){this.active_item=t,this.achat_mode=!0},startVente(t){this.active_item=t,this.achat_mod=!0},performFilter(t){let e=this.$store.state.salles.filter((e=>e.id==t|e.nom.toLowerCase().includes(t.toLowerCase())|e.type_poulle.toLowerCase().includes(t.toLowerCase())));this.items=e},download(t){const e=new Blob([t],{type:"text/csv"}),s=window.URL.createObjectURL(e),a=document.createElement("a");a.setAttribute("hidden",""),a.setAttribute("href",s),a.setAttribute("download","model.csv"),document.body.appendChild(a),a.click(),document.body.removeChild(a)},generateCSV(){let t=this.items,e="id;produit;quantite;prix_achat;details\n";for(var s=0;s<t.length;s++)e+=t[s].id+";"+t[s].nom+"\n";console.log(e),this.download(e)},level(t){return 0==t?"empty":t<=5?"low":void 0},onPickFile(){this.$refs.fileInput.click()},uploadCSV(t){if(t.target.files&&t.target.files[0]){let e=new FileReader;e.readAsBinaryString(t.target.files[0]),e.onload=t=>{console.log(t),this.csvData.size=t.total,this.csvData.fileData=t.target.result;let e=this.convertToJSON(this.csvData.fileData);console.log(e),console.table(e)}}},convertToJSON(t){let e=t.trim().split("\n"),s=[],a=e[0].split(";"),i=[],r={};e=e.slice(1);for(let o=0;o<e.length;o++){i=e[o].split(";");for(let t=0;t<i.length;t++)if(0===i.indexOf(i[t])||isNaN(i[t]))r[a[t]]=i[t];else{let e=Number.parseFloat(i[t]);r[a[t]]=e.toFixed(2)}s.push(r),r={}}return s}},mounted(){this.fetchData()}},Te=Ne,Oe=(0,h.Z)(Te,oe,ne,!1,null,"5154271b",null),Le=Oe.exports,Ie=function(){var t=this,e=t._self._c;return e("div",{staticClass:"parent"},[e("div",{staticClass:"top"},[e("SearchBar",{attrs:{show_date:!0},on:{searched:t.performFilter,changed:t.filterByDate}})],1),e("div",[e("button",{staticStyle:{float:"right","margin-right":"40px",margin:"20px"},on:{click:function(e){t.add_mod=!0}}},[e("fa",{attrs:{icon:"upload"}}),t._v(" Vendre Oeuf ")],1),e("button",{staticStyle:{float:"right","margin-right":"40px",margin:"20px"},on:{click:function(e){t.add_mode=!0}}},[e("fa",{attrs:{icon:"upload"}}),t._v(" Creer prix")],1)]),e("div",{staticClass:"recycler"}),e("div",{staticClass:"scrollable-tab"},[e("table",{staticClass:"table paiements"},[t._m(0),e("tbody",{attrs:{id:"paiements"}},t._l(t.items,(function(s,a){return e("tr",[e("th",[t._v(t._s(a+1))]),e("td",[t._v(t._s(s.salle.nom))]),e("td",[t._v(t._s(s.quantite)+" oeufs")]),e("td",[t._v(t._s(t.datetime(s.date)))])])})),0),e("tfoot",[e("tr",{staticClass:"panier-item"},[e("th",{attrs:{colspan:"2"}},[t._v("total")]),e("th",[t._v(t._s(t.total())+" oeufs")]),e("th")])])])]),e("Oeuf",{attrs:{visible:t.add_mod},on:{close:t.exitEdition}}),e("Item",{attrs:{visible:t.add_mode},on:{close:t.exitEdition}})],1)},Ee=[function(){var t=this,e=t._self._c;return e("thead",{staticStyle:{"text-transform":"capitalize"}},[e("tr",{staticClass:"panier-item"},[e("th",[t._v("#")]),e("th",[t._v("Salle")]),e("th",[t._v("quantite")]),e("th",[t._v("date")])])])}],Fe=function(){var t=this,e=t._self._c;return e("div",{class:{popup:!0,active:t.visible},on:{click:t.close}},[e("div",{ref:"modal",staticClass:"popup-body",on:{click:function(t){t.stopPropagation()}}},[e("center",[e("h3",[t._v("Ajouter prix")])]),e("form",{attrs:{method:"post"}},[e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_nom"}},[t._v("Prix:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.prix.prix,expression:"prix.prix"}],attrs:{type:"text",id:"id_nom",placeholder:"le prix de l'oeuf"},domProps:{value:t.prix.prix},on:{input:function(e){e.target.composing||t.$set(t.prix,"prix",e.target.value)}}})]),e("div",{staticClass:"logs"},[t._v(t._s(t.logs))]),e("div",{staticClass:"buttons"},[e("button",{ref:"submit",on:{click:function(e){return e.preventDefault(),t.createProduct.apply(null,arguments)}}},[t._v(" Créer ")])])])],1)])},ze=[],Ze={props:{visible:{type:Boolean,default:!1},modelaVisible:!0},data(){return{logs:"",prix:{},new_price:"",csv_array:[],csvData:{size:0,fileData:[]}}},computed:{headers(){return{headers:{Authorization:"Bearer "+this.$store.state.user.access}}}},methods:{close(){this.$emit("close")},createProduct(){this.prix.prix?n().post(this.$store.state.url+"/prix/",this.prix,this.headers).then((t=>{this.prix={},this.$store.state.prix.push(t.data),this.$emit("close")})).catch((t=>{console.error(t)})):this.logs="le prix est obligatoire"}}},je=Ze,Ue=(0,h.Z)(je,Fe,ze,!1,null,"11cd5e9a",null),Ve=Ue.exports,Re=function(){var t=this,e=t._self._c;return e("div",{class:{popup:!0,active:t.visible},on:{click:t.close}},[e("div",{staticClass:"popup-body",on:{click:function(t){t.preventDefault(),t.stopPropagation()},keydown:function(t){t.stopPropagation()}}},[e("center",[e("h3",[t._v("Vente oeufs")])]),e("form",{attrs:{method:"post"}},[e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_nom"}},[t._v("Quantite")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.oeuf.quantite,expression:"oeuf.quantite"}],attrs:{type:"number",list:"noms",id:"id_nom",placeholder:"quantite à vendre"},domProps:{value:t.oeuf.quantite},on:{input:function(e){e.target.composing||t.$set(t.oeuf,"quantite",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_nom"}},[t._v("Nom du client")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.client.nom,expression:"client.nom"}],attrs:{type:"text",list:"noms",id:"id_nom"},domProps:{value:t.client.nom},on:{change:t.setTel,input:function(e){e.target.composing||t.$set(t.client,"nom",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_tel"}},[t._v("Téléphone")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.client.tel,expression:"client.tel"}],attrs:{type:"text",id:"id_tel",list:"tels"},domProps:{value:t.client.tel},on:{change:t.setNom,input:function(e){e.target.composing||t.$set(t.client,"tel",e.target.value)}}})]),e("div",{staticClass:"buttons"},[e("div",{staticClass:"logs"},[t._v(t._s(t.logs))]),e("input",{attrs:{type:"submit",value:"Vendre"},on:{click:t.postCommande}})])]),e("datalist",{attrs:{id:"noms"}},t._l(t.clients,(function(t){return e("option",{domProps:{value:t.nom}})})),0),e("datalist",{attrs:{id:"tels"}},t._l(t.clients,(function(t){return e("option",{domProps:{value:t.tel}})})),0)],1)])},Qe=[],Je={props:{visible:{type:Boolean,default:!1},modelaVisible:!0},data(){return{logs:"",oeuf:{quantite:0},client:{nom:"",tel:""}}},computed:{clients(){return this.$store.state.clients},host(){return this.$store.state.url},username(){return this.$store.state.user.username},headers(){return{headers:{Authorization:"Bearer "+this.$store.state.user.access}}}},mounted(){this.clients.length<1&&n().get(this.$store.state.url+"/client/",this.headers).then((t=>{this.$store.state.clients=t.data.results})).catch((t=>{}))},methods:{close(){this.$emit("close")},setTel(){for(let t of this.clients)if(t.nom==this.client.nom)return void(this.client.tel=t.tel)},setNom(){for(let t of this.clients)if(t.tel==this.client.tel)return void(this.client.nom=t.nom)},postCommande(){if(this.client.tel.length<7)return void(this.logs="le numero est obligatoire pour les dettes");let t={};t={client:this.client},n().post(this.$store.state.url+"/oeuf_vendu/",{client:this.client,quantite:this.oeuf.quantite},this.headers).then((t=>{let e=t.data;this.client={nom:"",tel:""},this.oeuf={quantite:""},this.$store.state.oeufs_vendus.unshift(e),this.$emit("close")})).catch((t=>{t.response?this.logs=t.response.data.status:(this.logs="une erreur est survenue",console.error(t))}))}}},Me=Je,Ge=(0,h.Z)(Me,Re,Qe,!1,null,"0cb0b12c",null),He=Ge.exports,Ke={components:{SearchBar:T,Item:Ve,Oeuf:He},data(){return{csvData:{},items:this.$store.state.oeufs,active_item:{},edit_mode:!1,add_mod:!1,add_mode:!1}},watch:{"$store.state.oeufs"(t){this.items=t}},methods:{filterByDate(t){let e=t.du,s=t.au,a={headers:{Authorization:"Bearer "+this.$store.state.user.access}};n().get(this.$store.state.url+`/oeuf/?du=${e}&au=${s}`,a).then((t=>{this.query_date=!0,this.items=t.data.results})).catch((t=>{this.query_date=!1,console.log(t)}))},fetchData(){let t={headers:{Authorization:"Bearer "+this.$store.state.user.access}};0==this.$store.state.users.length&&n().get(this.$store.state.url+"/oeuf/",t).then((t=>{this.$store.state.oeufs=t.data.results,this.items=t.data.results,console.log(t.data.results)})).catch((t=>{t.response||console.error(t)}))},total(){let t=0;for(let e of this.items)t+=e.quantite;return t},exitEdition(){this.active_item={},this.edit_mode=!1,this.add_mod=!1,this.add_mode=!1},startEdit(t){this.active_item=t,this.edit_mode=!0},startAchat(t){this.active_item=t,this.achat_mode=!0},performFilter(t){let e=this.$store.state.oeufs.filter((e=>e.id==t|e.salle.nom.toLowerCase().includes(t.toLowerCase())));this.items=e},download(t){const e=new Blob([t],{type:"text/csv"}),s=window.URL.createObjectURL(e),a=document.createElement("a");a.setAttribute("hidden",""),a.setAttribute("href",s),a.setAttribute("download","model.csv"),document.body.appendChild(a),a.click(),document.body.removeChild(a)},generateCSV(){let t=this.items,e="id;produit;quantite;prix_achat;details\n";for(var s=0;s<t.length;s++)e+=t[s].id+";"+t[s].nom+"\n";console.log(e),this.download(e)},level(t){return 0==t?"empty":t<=5?"low":void 0},onPickFile(){this.$refs.fileInput.click()},uploadCSV(t){if(t.target.files&&t.target.files[0]){let e=new FileReader;e.readAsBinaryString(t.target.files[0]),e.onload=t=>{console.log(t),this.csvData.size=t.total,this.csvData.fileData=t.target.result;let e=this.convertToJSON(this.csvData.fileData);console.log(e),console.table(e)}}},convertToJSON(t){let e=t.trim().split("\n"),s=[],a=e[0].split(";"),i=[],r={};e=e.slice(1);for(let o=0;o<e.length;o++){i=e[o].split(";");for(let t=0;t<i.length;t++)if(0===i.indexOf(i[t])||isNaN(i[t]))r[a[t]]=i[t];else{let e=Number.parseFloat(i[t]);r[a[t]]=e.toFixed(2)}s.push(r),r={}}return s}},mounted(){this.fetchData()}},Xe=Ke,We=(0,h.Z)(Xe,Ie,Ee,!1,null,"936c4dfa",null),Ye=We.exports,ts=function(){var t=this,e=t._self._c;return e("div",{staticClass:"parent",on:{click:function(e){t.popover_opened=!1}}},[e("div",{staticClass:"top"},[e("SearchBar",{on:{changed:t.filterByDate,searched:t.searchItem}})],1),e("div",{staticClass:"recycler"}),e("div",{staticClass:"scrollable-tab"},[e("table",{staticClass:"table dettes"},[t._m(0),e("tbody",{attrs:{id:"dettes"}},t._l(t.dettes,(function(s){return e("tr",{class:{uncommited:s.uncommited>0}},[e("td",[t._v(t._s(s.id))]),e("td",[t._v(t._s(s.client))]),e("td",[t._v(t._s(t.datetime(s.date)))]),e("td",[t._v(t._s(s.a_payer)+" Fbu")]),e("td",[t._v(t._s(s.payee+s.uncommited)+" Fbu")]),e("td",[t._v(t._s(s.reste-s.uncommited)+" Fbu")]),e("td",[e("div",{staticClass:"btns"},[s.uncommited<s.reste?e("button",{on:{click:function(e){return t.rembourser(s)}}},[t._v(" payer ")]):t._e()])])])})),0),e("tfoot",[e("tr",{staticClass:"panier-item"},[e("th",[t._v("total")]),e("th"),e("th"),e("th",[t._v(t._s(t.totals.a_payer)+" Fbu")]),e("th",[t._v(t._s(t.totals.payee)+" Fbu")]),e("th",[t._v(t._s(t.totals.reste)+" Fbu")]),e("th")])])])]),e("RemboursDialog",{attrs:{visible:t.rembours_opened,dette:t.active_dette},on:{close:function(e){t.rembours_opened=!1}}})],1)},es=[function(){var t=this,e=t._self._c;return e("thead",[e("tr",{staticClass:"panier-item"},[e("th",[t._v("id")]),e("th",[t._v("client")]),e("th",[t._v("Date")]),e("th",[t._v("somme")]),e("th",[t._v("payée")]),e("th",[t._v("Reste")]),e("th",[t._v("options")])])])}],ss=function(){var t=this,e=t._self._c;return e("div",{class:{popup:!0,active:t.visible},on:{click:t.close}},[e("div",{staticClass:"popup-body",on:{click:function(t){t.preventDefault(),t.stopPropagation()}}},[e("center",[e("h3",[t._v("Client")])]),e("form",{attrs:{method:"post"}},[e("div",[t._v(" La somme à payer "),e("b",[t._v(t._s(t.money(t.reste)))]),t._v("Fbu ")]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_payee"}},[t._v("La somme payée")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.payee,expression:"payee"}],attrs:{type:"number",id:"id_payee"},domProps:{value:t.payee},on:{input:function(e){e.target.composing||(t.payee=e.target.value)}}})]),e("div",[t._v(" La somme à retourner "),e("b",[t._v(t._s(t.money(t.dette.reste-t.payee)))]),t._v("Fbu ")]),e("div",{staticClass:"buttons"},[e("div",{staticClass:"logs"},[t._v(t._s(t.logs))]),e("input",{attrs:{type:"submit",value:"Payer"},on:{click:t.makePayment}})])])],1)])},as=[],is={props:{visible:{type:Boolean,default:!1},dette:{type:Object,required:!0}},data(){return{dette_p:null,logs:""}},computed:{payee:{get(){return""==this.dette_p?0:null!=this.dette_p?this.dette_p:this.reste},set(t){this.dette_p=t}},reste(){return this.dette.reste-this.dette.uncommited}},methods:{close(){this.dette_p=null,this.$emit("close")},makePayment(t){this.payee=this.payee>this.reste?this.reste:this.payee;let e={somme:this.payee,commande:this.dette.id},s={headers:{Authorization:"Bearer "+this.$store.state.user.access}};n().post(this.$store.state.url+"/paiement/",e,s).then((t=>{let e=t.data,s=this.$store.state.commandes.find((t=>t.id==this.dette.id)),a=this.$store.state.dettes.find((t=>t.id==this.dette.id));s&&(s.uncommited=e.somme),a&&(this.dette.uncommited+=e.somme),this.$emit("close")})).catch((t=>{t.response?this.logs=t.response.data.status:this.logs="une erreur est survenue"}))}}},rs=is,os=(0,h.Z)(rs,ss,as,!1,null,"82aedf74",null),ns=os.exports,ls={components:{SearchBar:T,RemboursDialog:ns},data(){return{dettes:this.$store.state.dettes,rembours_opened:!1,active_dette:{},query_date:!1}},computed:{totals(){let t={a_payer:0,payee:0,reste:0};if(0==this.dettes.length)return t;for(let e of this.dettes)t.a_payer+=e.a_payer,t.payee+=e.payee,t.reste+=e.reste-e.uncommited;return t}},methods:{searchItem(t){let e={};""!=t?(t=t.toLowerCase(),e=this.dettes.filter((e=>e.id==t||e.user.toLowerCase().includes(t)||this.datetime(e.date).includes(t)||e.client.toLowerCase().includes(t))),this.dettes=e):this.dettes=this.$store.state.dettes},rembourser(t){this.active_dette=t,this.rembours_opened=!0},fetchData(){let t={headers:{Authorization:"Bearer "+this.$store.state.user.access}};n().get(this.$store.state.url+"/commande/dettes/",t).then((t=>{this.$store.state.dettes=t.data,this.dettes=t.data,this.$store.state.dettes_fetched=!0})).catch((e=>{if("token_not_valid"==e.response.data.code){let e={refresh:this.$store.state.user.refresh};n().post(this.$store.state.url+"/refresh/",e).then((e=>{this.$store.state.user.access=e.data.access,t.headers.Authorization="Bearer "+e.data.access})).catch((t=>{this.$store.state.user=null}))}}))},filterByDate(t){let e=t.du,s=t.au,a={headers:{Authorization:"Bearer "+this.$store.state.user.access}};n().get(this.$store.state.url+"/commande/dettes/"+e+"/"+s+"/",a).then((t=>{this.query_date=!0,this.dettes=t.data})).catch((t=>{this.query_date=!1,console.error(t)}))}},mounted(){this.$store.state.dettes_fetched||this.fetchData()}},us=ls,cs=(0,h.Z)(us,ts,es,!1,null,"0d9b744c",null),ds=(cs.exports,function(){var t=this,e=t._self._c;return e("div",{staticClass:"parent"},[e("div",{staticClass:"top"},[e("SearchBar",{attrs:{show_date:!0},on:{changed:t.filterByDate,searched:t.performFilter}})],1),e("br"),e("div",[t.$store.state.user.groups.includes("admin")?e("label",[e("button",{on:{click:function(e){t.add_mod=!0}}},[t._v("Taux")]),e("button",{on:{click:function(e){t.add_mode=!0}}},[t._v("Ajouter")])]):t._e()]),e("div",{staticClass:"recycler"}),e("div",{staticClass:"scrollable-tab"},[e("table",{staticClass:"table paiements"},[e("thead",{staticStyle:{"text-transform":"capitalize"}},[e("tr",{staticClass:"panier-item"},[e("th",[t._v("#")]),e("th",[t._v("nom & Prenom")]),e("th",[t._v("telephone")]),e("th",[t._v("Adresse")]),t.$store.state.user.groups.includes("admin")?e("th",[t._v("montant ($)")]):t._e(),e("th",[t._v("montant (Fbu)")]),t.$store.state.user.groups.includes("admin")?e("th",[t._v("taux")]):t._e(),t.$store.state.user.groups.includes("admin")?e("th",[t._v("Frais")]):t._e(),e("th",[t._v("date")]),e("th",[t._v("valider")])])]),e("tbody",{attrs:{id:"paiements"}},t._l(t.items,(function(s,a){return e("tr",[e("th",[t._v(t._s(a+1))]),e("td",[t._v(t._s(s.nom)+" "+t._s(s.prenom))]),e("td",[t._v(t._s(s.telephone))]),e("td",[t._v(t._s(s.adresse))]),t.$store.state.user.groups.includes("admin")?e("td",[t._v(t._s(t.money(s.montant_euro))+" $")]):t._e(),e("td",[t._v(t._s(t.money(s.montant_euro*s.taux-s.montant_euro*s.taux*s.frais/100))+" Fbu")]),t.$store.state.user.groups.includes("admin")?e("td",[t._v(t._s(s.taux)+" Fbu")]):t._e(),t.$store.state.user.groups.includes("admin")?e("td",[t._v(t._s(s.frais)+" %")]):t._e(),e("td",[t._v(t._s(t.datetime(s.date)))]),0==s.validated?e("td",[e("div",{staticClass:"btns"},[t.$store.state.user.groups.includes("admin")?e("button",{on:{click:function(e){return e.preventDefault(),t.startEdit(s)}}},[t._v("Edit")]):t._e(),t.$store.state.user.groups.includes("admin")?e("button",{staticStyle:{"background-color":"red"},on:{click:function(e){return e.preventDefault(),t.Delete(s)}}},[t._v("Delete")]):t._e()]),e("div",{staticClass:"btns"},[t.$store.state.user.groups.includes("gestionnaire")?e("button",{staticClass:"valider",on:{click:function(e){return e.preventDefault(),t.Valider(s)}}},[t._v("valider")]):t._e()])]):e("td")])})),0),e("tfoot",[e("tr",{staticClass:"panier-item"},[e("th",{attrs:{colspan:"4"}},[t._v("Total")]),t.$store.state.user.groups.includes("admin")?e("th",[t._v(t._s(t.money(t.total()))+" $")]):t._e(),e("th",[t._v(t._s(t.money(t.totale()))+" Fbu")]),e("th",{attrs:{colspan:"3"}})])])])]),e("EditDialog",{attrs:{visible:t.edit_mode,produit:t.active_item},on:{close:t.exitEdition}}),e("AchatDialog",{attrs:{visible:t.achat_mode,produit:t.active_item},on:{close:t.exitEdition}}),e("ProduitDialog",{attrs:{visible:t.add_mode},on:{close:t.exitEdition}}),e("TauxDialog",{attrs:{visible:t.add_mod},on:{close:t.exitEdition}})],1)}),hs=[],ps=function(){var t=this,e=t._self._c;return e("div",{class:{popup:!0,active:t.visible},on:{click:t.close}},[e("div",{staticClass:"popup-body",on:{click:function(t){t.preventDefault(),t.stopPropagation()}}},[e("center",[e("h3",[t._v("Modifier "+t._s(t.produit.montant))])]),e("form",{attrs:{method:"post"}},[e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_unite"}},[t._v("Nom:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.new_produit.nom,expression:"new_produit.nom"}],attrs:{type:"text",id:"id_unite"},domProps:{value:t.new_produit.nom},on:{input:function(e){e.target.composing||t.$set(t.new_produit,"nom",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_unite"}},[t._v("Prenom:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.new_produit.prenom,expression:"new_produit.prenom"}],attrs:{type:"text",id:"id_unite"},domProps:{value:t.new_produit.prenom},on:{input:function(e){e.target.composing||t.$set(t.new_produit,"prenom",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_unite"}},[t._v("Adresse:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.new_produit.adresse,expression:"new_produit.adresse"}],attrs:{type:"text",id:"id_unite"},domProps:{value:t.new_produit.adresse},on:{input:function(e){e.target.composing||t.$set(t.new_produit,"adresse",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_unite"}},[t._v("Telephone:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.new_produit.telephone,expression:"new_produit.telephone"}],attrs:{type:"text",id:"id_unite"},domProps:{value:t.new_produit.telephone},on:{input:function(e){e.target.composing||t.$set(t.new_produit,"telephone",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_prix"}},[t._v("Nouveau montant:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.new_produit.montant_euro,expression:"new_produit.montant_euro"}],attrs:{type:"number",name:"prix",placeholder:"montant en euro",required:"",id:"id_quantite"},domProps:{value:t.new_produit.montant_euro},on:{input:function(e){e.target.composing||t.$set(t.new_produit,"montant_euro",e.target.value)}}})]),e("div",{staticClass:"buttons"},[e("div",{staticClass:"logs"},[t._v(t._s(t.logs))]),e("input",{attrs:{type:"submit",value:"Modifier"},on:{click:t.changerPrix}})])])],1)])},ms=[],vs={props:{visible:{type:Boolean,default:!1},produit:{type:Object,required:!0}},data(){return{logs:"",new_price:"",new_produit:""}},watch:{produit(t){this.new_produit=JSON.parse(JSON.stringify(t))}},methods:{close(){this.$emit("close")},changerPrix(){let t={headers:{Authorization:"Bearer "+this.$store.state.user.access}};n().put(this.$store.state.url+`/transaction/${this.produit.id}/`,this.new_produit,t).then((t=>{let e=this.$store.state.transactions;for(var s=0;s<e.length;s++){let a=e[s];if(a.id==this.produit.id){this.$store.state.transactions[s]=t.data;break}}this.$emit("close")})).catch((t=>{console.error(t)}))}}},_s=vs,fs=(0,h.Z)(_s,ps,ms,!1,null,"2bd9af5e",null),gs=fs.exports,bs=function(){var t=this,e=t._self._c;return e("div",{class:{popup:!0,active:t.visible},on:{click:t.close}},[e("div",{ref:"modal",staticClass:"popup-body",on:{click:function(t){t.stopPropagation()}}},[e("center",[e("h3",[t._v("Creer Tranfer")])]),e("form",{attrs:{method:"post"}},[e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_nom"}},[t._v("Nom:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.transaction.nom,expression:"transaction.nom"}],attrs:{type:"text",id:"id_nom",placeholder:"le nom "},domProps:{value:t.transaction.nom},on:{input:function(e){e.target.composing||t.$set(t.transaction,"nom",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_nom"}},[t._v("Prenom:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.transaction.prenom,expression:"transaction.prenom"}],attrs:{type:"text",id:"id_nom",placeholder:"le prenom"},domProps:{value:t.transaction.prenom},on:{input:function(e){e.target.composing||t.$set(t.transaction,"prenom",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_nom"}},[t._v("Adresse:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.transaction.adresse,expression:"transaction.adresse"}],attrs:{type:"text",id:"id_nom",placeholder:"adresse"},domProps:{value:t.transaction.adresse},on:{input:function(e){e.target.composing||t.$set(t.transaction,"adresse",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_entrant"}},[t._v("Telephone:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.transaction.telephone,expression:"transaction.telephone"}],attrs:{type:"text",id:"id_entrant",placeholder:"exemples: +25779462806"},domProps:{value:t.transaction.telephone},on:{input:function(e){e.target.composing||t.$set(t.transaction,"telephone",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_prix"}},[t._v("Montant:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.transaction.montant_euro,expression:"transaction.montant_euro"}],attrs:{type:"number",name:"prix",placeholder:"le montant en euro",id:"id_prix"},domProps:{value:t.transaction.montant_euro},on:{input:function(e){e.target.composing||t.$set(t.transaction,"montant_euro",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_prix"}},[t._v("Frais:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.transaction.frais,expression:"transaction.frais"}],attrs:{type:"number",name:"prix",placeholder:"frais en %",id:"id_prix"},domProps:{value:t.transaction.frais},on:{input:function(e){e.target.composing||t.$set(t.transaction,"frais",e.target.value)}}})]),e("div",{staticClass:"field",attrs:{hidden:""}},[e("label",{attrs:{for:"id_nom"}},[t._v("Taux")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.tau.taux,expression:"tau.taux"}],attrs:{type:"number",list:"noms",placeholder:"taux de change",id:"id_nom"},domProps:{value:t.tau.taux},on:{change:t.setTaux,input:function(e){e.target.composing||t.$set(t.tau,"taux",e.target.value)}}})]),e("div",{staticClass:"logs"},[t._v(t._s(t.logs))]),e("div",{staticClass:"buttons"},[e("button",{ref:"submit",on:{click:function(e){return e.preventDefault(),t.createTransaction.apply(null,arguments)}}},[t._v(" Créer ")])])]),e("datalist",{attrs:{id:"noms"}},t._l(t.taux,(function(t){return e("option",{domProps:{value:t.taux}})})),0)],1)])},ys=[],xs={props:{visible:{type:Boolean,default:!1},modelaVisible:!0},data(){return{logs:"",transaction:{},tau:{},new_price:"",csv_array:[],csvData:{size:0,fileData:[]}}},watch:{csv_array(t){if(0==t.length)return this.logs="",void(this.$refs.submit.innerText="Créer");this.logs=t.length+" transactions chargés",this.$refs.submit.innerText="upload"}},mounted(){n().get(this.$store.state.url+"/taux/",this.headers).then((t=>{this.$store.state.taux=t.data.results})).catch((t=>{}))},computed:{taux(){return this.$store.state.taux},headers(){return{headers:{Authorization:"Bearer "+this.$store.state.user.access}}}},methods:{setTaux(){for(let t of this.taux)if(t.date=this.tau.date)return void(this.tau.taux=t.taux)},setNom(){for(let t of this.taux)if(t.taux==this.tau.taux)return void(this.tau.date=t.date)},close(){this.$emit("close")},createTransaction(){let t={nom:this.transaction.nom,prenom:this.transaction.prenom,telephone:this.transaction.telephone,adresse:this.transaction.adresse,montant_euro:this.transaction.montant_euro,frais:this.transaction.frais,tau:this.tau};n().post(this.$store.state.url+"/transaction/",t,this.headers).then((t=>{this.transaction={},this.$store.state.transactions.push(t.data),this.$emit("close")})).catch((t=>{console.error(t)}))},download(t){const e=new Blob([t],{type:"text/csv"}),s=window.URL.createObjectURL(e),a=document.createElement("a");a.setAttribute("hidden",""),a.setAttribute("href",s),a.setAttribute("download","model.csv"),document.body.appendChild(a),a.click(),document.body.removeChild(a)},generateCSV(){let t='"sep=;"\nnom;unite;unite_sortant;rapport;prix_vente\n';this.download(t)},onPickFile(){this.$refs.fileInput.click()},loadCSV(t){if(t.target.files&&t.target.files[0]){let e=new FileReader;e.readAsBinaryString(t.target.files[0]),e.onload=t=>{this.csvData.size=t.total,this.csvData.fileData=t.target.result;let e=this.convertToJSON(this.csvData.fileData);this.csv_array=e}}},convertToJSON(t){let e=t.trim().split("\n"),s=[],a=e[0].trim().split(";"),i=[],r={};e=e.slice(1);for(let o=0;o<e.length;o++){i=e[o].trim().split(";");for(let t=0;t<i.length;t++)r[a[t]]=i[t];s.push(r),r={}}return s}}},$s=xs,Cs=(0,h.Z)($s,bs,ys,!1,null,"274b4bd2",null),ws=Cs.exports,qs=function(){var t=this,e=t._self._c;return e("div",{class:{popup:!0,active:t.visible},on:{click:t.close}},[e("div",{ref:"modal",staticClass:"popup-body",on:{click:function(t){t.stopPropagation()}}},[e("center",[e("h3",[t._v("Creer Taux")])]),e("form",{attrs:{method:"post"}},[e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_nom"}},[t._v("Taux:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.taux.taux,expression:"taux.taux"}],attrs:{type:"text",id:"id_taux",placeholder:"le taux d'echange "},domProps:{value:t.taux.taux},on:{input:function(e){e.target.composing||t.$set(t.taux,"taux",e.target.value)}}})]),e("div",{staticClass:"logs"},[t._v(t._s(t.logs))]),e("div",{staticClass:"buttons"},[e("button",{ref:"submit",on:{click:function(e){return e.preventDefault(),t.createtaux.apply(null,arguments)}}},[t._v(" Créer ")])])])],1)])},ks=[],Ps={props:{visible:{type:Boolean,default:!1},modelaVisible:!0},data(){return{logs:"",taux:{}}},computed:{headers(){return{headers:{Authorization:"Bearer "+this.$store.state.user.access}}}},methods:{close(){this.$emit("close")},createtaux(){let t={taux:this.taux.taux};n().post(this.$store.state.url+"/taux/",t,this.headers).then((t=>{this.taux={},this.$store.state.taux.push(t.data),this.$emit("close")})).catch((t=>{console.error(t)}))}}},Ds=Ps,Ss=(0,h.Z)(Ds,qs,ks,!1,null,"0f29037d",null),Bs=Ss.exports,As={components:{SearchBar:T,Item:Et,EditDialog:gs,AchatDialog:ee,ProduitDialog:ws,TauxDialog:Bs},data(){return{csvData:{},items:this.$store.state.transactions,active_item:{},edit_mode:!1,achat_mode:!1,add_mode:!1,add_mod:!1}},watch:{"$store.state.transactions"(t){this.items=t}},methods:{Delete(t){let e={headers:{Authorization:"Bearer "+this.$store.state.user.access}};confirm("Delete "+t.id)&&n()["delete"](this.$store.state.url+`/transaction/${t.id}/`,e).then((t=>(this.fetchData(),t)))},successAlert(){this.$swal({type:"success",title:"Valider la transaction",text:"Transaction validée avec succès!!!!"})},Valider(t){let e={headers:{Authorization:"Bearer "+this.$store.state.user.access}};n().get(this.$store.state.url+`/transaction/${t.id}/valider/`,e).then((t=>{this.fetchData(),this.successAlert()}))},performFilter(t){let e=this.$store.state.transactions.filter((e=>e.id==t|e.nom.toLowerCase().includes(t.toLowerCase())|e.telephone.toLowerCase().includes(t.toLowerCase())|e.prenom.toLowerCase().includes(t.toLowerCase())));this.items=e},fetchData(){let t={headers:{Authorization:"Bearer "+this.$store.state.user.access}};0==this.$store.state.users.length&&n().get(this.$store.state.url+"/transaction/",t).then((t=>{this.$store.state.transactions=t.data.results,this.items=t.data.results,console.log(t.data.results)})).catch((t=>{t.response||console.error(t)}))},filterByDate(t){let e=t.du,s=t.au,a={headers:{Authorization:"Bearer "+this.$store.state.user.access}};n().get(this.$store.state.url+`/transaction/?du=${e}&au=${s}`,a).then((t=>{this.query_date=!0,this.items=t.data.results})).catch((t=>{this.query_date=!1,console.log(t)}))},total(){let t=0;for(let e of this.items)1==e.validated&&(t+=e.montant_euro);return t},totale(){let t=0;for(let e of this.items)1==e.validated&&(t+=e.montant_euro*e.taux-e.montant_euro*e.taux*e.frais/100);return t},exitEdition(){this.active_item={},this.edit_mode=!1,this.achat_mode=!1,this.add_mode=!1,this.add_mod=!1},startEdit(t){this.active_item=t,this.edit_mode=!0},startAchat(t){this.active_item=t,this.achat_mode=!0},download(t){const e=new Blob([t],{type:"text/csv"}),s=window.URL.createObjectURL(e),a=document.createElement("a");a.setAttribute("hidden",""),a.setAttribute("href",s),a.setAttribute("download","model.csv"),document.body.appendChild(a),a.click(),document.body.removeChild(a)},level(t){return 0==t?"empty":t<=5?"low":void 0},onPickFile(){this.$refs.fileInput.click()}},mounted(){this.fetchData()}},Ns=As,Ts=(0,h.Z)(Ns,ds,hs,!1,null,"4e5f4c1e",null),Os=Ts.exports,Ls=function(){var t=this,e=t._self._c;return e("div",{staticClass:"parent",on:{click:function(e){t.popover_opened=!1}}},[e("div",{staticClass:"top"},[e("SearchBar",{attrs:{show_date:t.userIs("admin")},on:{changed:t.filterByDate,searched:t.searchItem}})],1),e("div",{staticClass:"recycler"}),e("div",{staticClass:"scrollable-tab"},[e("table",{staticClass:"table achats"},[t._m(0),e("tbody",{attrs:{id:"achats"}},t._l(t.achats,(function(s,a){return e("tr",[e("th",[t._v(t._s(a+1))]),e("td",[t._v(t._s(s.produit))]),e("td",[t._v(t._s(s.quantite))]),e("td",[t._v(t._s(t.money(s.prix_unitaire)))]),e("td",[t._v(t._s(t.money(s.prix_total))+" Fbu")]),e("td",[t._v(t._s(s.user))]),e("td",[t._v(t._s(t.datetime(s.date)))]),e("td",[t._v(t._s(s.details))])])})),0),e("tfoot",[e("tr",{staticClass:"panier-item"},[e("th",{attrs:{colspan:"4"}},[t._v("total")]),e("th",[t._v(t._s(t.money(t.total))+" Fbu")]),e("th",{attrs:{colspan:"3"}})])])])]),e("AchatDialog",{attrs:{visible:t.achat_mode,achat:t.active_item,produit:t.produit},on:{close:t.exitEdition}})],1)},Is=[function(){var t=this,e=t._self._c;return e("thead",[e("tr",{staticClass:"panier-item",staticStyle:{"text-transform":"capitalize"}},[e("th",[t._v("#")]),e("th",[t._v("nom")]),e("th",[t._v("quantité")]),e("th",[t._v("prix unitaire")]),e("th",[t._v("prix d'achat")]),e("th",[t._v("acheteur")]),e("th",[t._v("date")]),e("th",[t._v("Detail")])])])}],Es={data(){return{achats:this.$store.state.achats,query_date:!1,active_item:null,achat_mode:!1}},components:{SearchBar:T,AchatDialog:ee},watch:{"$store.state.achats"(t){this.achats=this.$store.state.achats}},computed:{total(){let t=0;if(0==this.achats.length)return t;for(let e of this.achats)t+=e.prix_total;return t},produit(){if(!this.active_item)return{rapport:1};let t;return console.log(this.active_item),t=this.$store.state.produits.find((t=>t.nom==this.active_item.produit)),t}},methods:{searchItem(t){let e={};this.achats=this.$store.state.achats,""!=t&&(t=t.toLowerCase().split(","),e=this.achats.filter((e=>t[1]?(e.id==t||e.user.toLowerCase().includes(t[0])||this.datetime(e.date).includes(t[0])||e.produit.toLowerCase().includes(t[0]))&&(e.id==t||e.user.toLowerCase().includes(t[0])||this.datetime(e.date).includes(t[0])||e.produit.toLowerCase().includes(t[0])):e.id==t||e.user.toLowerCase().includes(t[0])||this.datetime(e.date).includes(t[0])||e.produit.toLowerCase().includes(t[0]))),this.achats=e)},getMonday(){let t=new Date;var e=t.getDay(),s=t.getDate()-e+(0==e?-6:1);return new Date(t.setDate(s)).toISOString()},fetchAchats(){let t={headers:{Authorization:"Bearer "+this.$store.state.user.access}},e=`date__lte=${(new Date).toISOString()}&date__gte=${this.getMonday()}`;n().get(this.$store.state.url+`/achat/?${e}`,t).then((t=>{this.$store.state.achats=t.data.results,this.achats=t.data.results})).catch((e=>{if("token_not_valid"==e.response.data.code){let e={refresh:this.$store.state.user.refresh};n().post(this.$store.state.url+"/refresh/",e).then((e=>{this.$store.state.user.access=e.data.access,t.headers.Authorization="Bearer "+e.data.access})).catch((t=>{this.$store.state.user=null}))}}))},filterByDate(t){let e=new Date(t.du).toISOString(),s=new Date(t.au).toISOString(),a=`date__lte=${s}&date__gte=${e}`,i={headers:{Authorization:"Bearer "+this.$store.state.user.access}};n().get(this.$store.state.url+`/achat/?${a}`,i).then((t=>{this.query_date=!0,this.$store.state.achats=t.data.results})).catch((t=>{this.query_date=!1,console.error(t)}))},modifier(t){this.active_item=t,this.achat_mode=!0},exitEdition(){this.achat_mode=!1}},mounted(){this.$store.state.achats_fetched||this.fetchAchats()}},Fs=Es,zs=(0,h.Z)(Fs,Ls,Is,!1,null,"1170cc7e",null),Zs=zs.exports,js=function(){var t=this,e=t._self._c;return e("div",{staticClass:"parent",on:{click:function(e){t.popover_opened=!1}}},[e("div",{staticClass:"top"},[e("SearchBar",{attrs:{show_date:t.userIs("admin")},on:{changed:t.filterByDate,searched:t.searchItem}})],1),e("div",{staticClass:"recycler"}),e("div",{staticClass:"scrollable-tab"},[e("table",{staticClass:"table commandes"},[t._m(0),e("tbody",{attrs:{id:"commandes"}},t._l(t.rations.results,(function(s,a){return e("tr",[e("th",[t._v(t._s(a+1))]),e("td",[t._v(t._s(t.datetime(s.date)))]),e("td",[t._v(t._s(s.responsable))]),e("td",[e("div",{staticClass:"btns"},[e("button",{on:{click:function(e){return t.showDetails(s)}}},[t._v(" détails ")])])])])})),0)])]),e("DetailsDialog",{attrs:{visible:t.details_opened,commande:t.active_commande},on:{close:function(e){t.details_opened=!1}}})],1)},Us=[function(){var t=this,e=t._self._c;return e("thead",[e("tr",{staticClass:"panier-item"},[e("th",[t._v("#")]),e("th",[t._v("Date")]),e("th",[t._v("Responsable")]),e("th",[t._v("options")])])])}],Vs=function(){var t=this,e=t._self._c;return e("div",{class:{popup:!0,active:t.visible},on:{click:t.close}},[e("div",{staticClass:"popup-body",on:{click:function(t){t.preventDefault(),t.stopPropagation()}}},[e("center",[e("h2",[t._v("Ration")])]),e("br"),0==t.ventes.length?e("div",[t._v(t._s(t.action))]):e("div",{staticClass:"scrollable-tab"},[e("table",{staticClass:"table commandes"},[t._m(0),e("tbody",{attrs:{id:"commandes"}},t._l(t.ventes,(function(s,a){return e("tr",[e("td",{staticStyle:{color:"#aaa"}},[t._v(t._s(a+1))]),e("td",[t._v(t._s(s.produit))]),e("td",[t._v("x "+t._s(s.quantite)+t._s(s.produit.unite))]),e("td",[t._v(t._s(t.money(s.prix_achat))+" Fbu")]),e("td",[t._v(t._s(t.money(s.prix_achat*s.quantite))+" Fbu")])])})),0),e("tfoot",[e("tr",{staticClass:"panier-item"},[e("th",{attrs:{colspan:"4"}},[t._v("total")]),e("th",[t._v(t._s(t.money(t.commande.a_payer))+" Fbu")])])])])])],1)])},Rs=[function(){var t=this,e=t._self._c;return e("thead",[e("tr",{staticClass:"panier-item"},[e("th",[t._v("#")]),e("th",[t._v("produit")]),e("th",[t._v("quantite")]),e("th",[t._v("prix Unitaire")]),e("th",[t._v("total")])])])}],Qs={data(){return{ventes:[],action:"récuperation des ventes..."}},props:{visible:{type:Boolean,default:!1},commande:{type:Object,required:!0}},watch:{visible(t){if(this.visible){let t={headers:{Authorization:"Bearer "+this.$store.state.user.access}};n().get(this.$store.state.url+"/vente/?commande="+this.commande.id,t).then((t=>{this.ventes=t.data.results,this.action="pas de details."})).catch((t=>{console.error(t)}))}}},methods:{close(){this.$emit("close")}}},Js=Qs,Ms=(0,h.Z)(Js,Vs,Rs,!1,null,"b0cc4ae6",null),Gs=Ms.exports,Hs={components:{SearchBar:T,DetailsDialog:Gs},data(){return{query_date:!1,rations:this.$store.state.rations,details_opened:!1,active_commande:{}}},computed:{totals(){let t={a_payer:0,payee:0,reste:0};if(0==this.commandes.length)return t;for(let e of this.commandes)t.a_payer+=e.a_payer,t.payee+=e.payee,t.reste+=e.reste;return t}},methods:{userIs(t){return this.$store.state.user.groups.includes(t)},searchItem(t){let e={};this.rations=this.$store.state.rations,""!=t&&(t=t.toLowerCase().split(","),e=this.$store.state.rations.filter((e=>t[1]?(e.id==t||e.user.toLowerCase().includes(t[0])||this.datetime(e.date).includes(t[0])||e.produit.toLowerCase().includes(t[0]))&&(e.id==t||e.user.toLowerCase().includes(t[0])||this.datetime(e.date).includes(t[0])||e.produit.toLowerCase().includes(t[0])):e.id==t||e.user.toLowerCase().includes(t[0])||this.datetime(e.date).includes(t[0])||e.produit.toLowerCase().includes(t[0]))),this.rations=e)},showDetails(t){this.active_commande=t,this.details_opened=!0},fetchData(){let t={headers:{Authorization:"Bearer "+this.$store.state.user.access}};n().get(this.$store.state.url+"/ration/",t).then((t=>{this.$store.state.rations=t.data,this.rations=t.data,this.$store.state.commandes_fetched=!0})).catch((t=>{if("token_not_valid"==t.response.data.code){let t={refresh:this.$store.state.user.refresh};n().post(this.$store.state.url+"/refresh/",t).then((t=>{this.$store.state.user.access=t.data.access,this.fetchData()})).catch((t=>{this.$store.state.user=null}))}}))},filterByDate(t){let e=t.du,s=t.au,a={headers:{Authorization:"Bearer "+this.$store.state.user.access}};n().get(this.$store.state.url+`/ration/?du=${e}&au=${s}`,a).then((t=>{this.query_date=!0,this.rations=t.data})).catch((t=>{this.query_date=!1,console.log(t)}))}},mounted(){this.fetchData()}},Ks=Hs,Xs=(0,h.Z)(Ks,js,Us,!1,null,"7423c310",null),Ws=Xs.exports,Ys=function(){var t=this,e=t._self._c;return e("div",{staticClass:"parent",on:{click:function(e){t.popover_opened=!1}}},[e("div",{staticClass:"top"},[e("SearchBar",{on:{changed:t.filterByDate,searched:t.performFilter}})],1),e("div",{staticClass:"recycler"}),e("div",{staticClass:"scrollable-tab"},[e("table",{staticClass:"table ventes"},[t._m(0),e("tbody",{attrs:{id:"ventes"}},t._l(Object.entries(t.grouped_ventes),(function(s,a){return e("tr",[e("td",[t._v(t._s(a+1))]),e("td",[t._v(t._s(s[0]))]),e("td",[t._v(t._s(s[1].quantite))]),e("td",[t._v(t._s(t.money(s[1].prix_achat||null)))])])})),0),e("tfoot",[e("tr",{staticClass:"panier-item"},[e("th",{attrs:{colspan:"3"}},[t._v("total")]),e("th",[t._v(t._s(t.money(t.totals.achat))+" Fbu")])])])])])])},ta=[function(){var t=this,e=t._self._c;return e("thead",[e("tr",{staticClass:"panier-item"},[e("th",[t._v("id")]),e("th",[t._v("produit")]),e("th",[t._v("quantité consommée")]),e("th",[t._v("prix d'achat total")])])])}],ea={components:{SearchBar:T},data(){return{ventes:[],query_date:!1}},computed:{totals(){let t={achat:0,vente:0};for(let e of Object.entries(this.grouped_ventes))t.vente+=e[1].prix_vente||0,t.achat+=e[1].prix_achat||0;return t},grouped_ventes(){let t={},e=null,s=0,a=0;for(let i of this.ventes)s=i.prix_vente*i.quantite,a=i.prix_achat*i.quantite,i.produit in t?(e=t[i.produit],e.quantite+=i.quantite,e.prix_vente+=s,e.prix_achat+=a,e.benefice+=i.prix_achat?s-a:0):e={id:i.produit_id,quantite:i.quantite,prix_achat:i.prix_achat*i.quantite,prix_vente:i.prix_vente*i.quantite,benefice:i.prix_achat?s-a:null},t[i.produit]=e;return t}},methods:{totalAchat(t){return t&&t.prix_achat?t.prix_achat*t.quantite:0},totalVente(t){return t?t.prix_vente*t.quantite:0},searchItem(t){this.ventes=""==t?this.$store.state.ventes:this.$store.state.ventes.filter((e=>e.produit.toLowerCase().includes(t.toLowerCase())))},performFilter(t){let e=this.$store.state.produits.filter((e=>e==t|e.toLowerCase().includes(t.toLowerCase())));this.items=e},filterByDate(t){let e=t.du,s=t.au,a={headers:{Authorization:"Bearer "+this.$store.state.user.access}},i=`/vente/?commande__date__gte=${e} 00:00&commande__date__lte=${s} 23:59`;n().get(this.$store.state.url+i,a).then((t=>{this.ventes=t.data.results})).catch((t=>{console.error(t)}))},fetchData(){let t={headers:{Authorization:"Bearer "+this.$store.state.user.access}},e=new Date,s=(new Date).toISOString(),a=new Date(e.setDate(1)).toISOString(),i=`/vente/?commande__date__gte=${a}&commande__date__lte=${s}`;n().get(this.$store.state.url+i,t).then((t=>{this.$store.state.ventes=t.data,this.ventes=t.data.results})).catch((t=>{}))}},mounted(){this.fetchData()}},sa=ea,aa=(0,h.Z)(sa,Ys,ta,!1,null,"305012c4",null),ia=aa.exports,ra=function(){var t=this,e=t._self._c;return e("div",{staticClass:"parent",on:{click:function(e){t.popover_opened=!1}}},[e("div",{staticClass:"top"},[e("SearchBar",{attrs:{show_date:t.userIs("admin")||t.userIs("gestionnaire")},on:{changed:t.filterByDate,searched:t.performFilter}})],1),e("div",{staticClass:"recycler"}),e("div",{staticClass:"scrollable-tab"},[e("table",{staticClass:"table commandes"},[t._m(0),e("tbody",{attrs:{id:"commandes"}},t._l(t.items,(function(s,a){return e("tr",[e("th",[t._v(t._s(a+1))]),e("td",[t._v(t._s(t.datetime(s.date)))]),e("td",[t._v(t._s(s.client))]),e("td",[t._v(t._s(s.prix)+" Fbu")]),e("td",[t._v(t._s(s.quantite))]),e("td",[t._v(t._s(t.money(s.prix*s.quantite))+" Fbu")])])})),0),e("tfoot",[e("tr",{staticClass:"panier-item"},[e("th",{attrs:{colspan:"4"}},[t._v("Total")]),e("th",[t._v(t._s(t.totale())+" oeufs")]),e("th",[t._v(t._s(t.money(t.total()))+" Fbu")])])])])]),e("DetailsDialog",{attrs:{visible:t.details_opened,commande:t.active_commande},on:{close:function(e){t.details_opened=!1}}})],1)},oa=[function(){var t=this,e=t._self._c;return e("thead",[e("tr",{staticClass:"panier-item"},[e("th",[t._v("#")]),e("th",[t._v("Date")]),e("th",[t._v("Client")]),e("th",[t._v("Prix")]),e("th",[t._v("Quantite")]),e("th",[t._v("Total")])])])}],na={components:{SearchBar:T,DetailsDialog:Gs},data(){return{query_date:!1,items:this.$store.state.oeufs_vendus,details_opened:!1,active_commande:{}}},watch:{"$store.state.items"(t){this.items=t}},methods:{total(){let t=0;for(let e of this.items)t+=e.prix*e.quantite;return t},totale(){let t=0;for(let e of this.items)t+=e.quantite;return t},userIs(t){return this.$store.state.user.groups.includes(t)},performFilter(t){let e=this.$store.state.oeufs_vendus.filter((e=>e.id==t|e.client.toLowerCase().includes(t.toLowerCase())|e.date.toLowerCase().includes(t.toLowerCase())));this.items=e},fetchData(){let t={headers:{Authorization:"Bearer "+this.$store.state.user.access}};n().get(this.$store.state.url+"/oeuf_vendu/",t).then((t=>{this.$store.state.oeufs_vendus=t.data.results,this.items=t.data.results,this.$store.state.commandes_fetched=!0})).catch((t=>{if("token_not_valid"==t.response.data.code){let t={refresh:this.$store.state.user.refresh};n().post(this.$store.state.url+"/refresh/",t).then((t=>{this.$store.state.user.access=t.data.access,this.fetchData()})).catch((t=>{this.$store.state.user=null}))}}))},filterByDate(t){let e=t.du,s=t.au,a={headers:{Authorization:"Bearer "+this.$store.state.user.access}};n().get(this.$store.state.url+`/oeuf_vendu/?du=${e}&au=${s}`,a).then((t=>{this.query_date=!0,this.items=t.data.results})).catch((t=>{this.query_date=!1,console.log(t)}))}},mounted(){this.fetchData()}},la=na,ua=(0,h.Z)(la,ra,oa,!1,null,"ba5e35c0",null),ca=ua.exports,da=function(){var t=this,e=t._self._c;return e("div",{staticClass:"parent",on:{click:function(e){t.popover_opened=!1}}},[e("div",{staticClass:"top"},[e("SearchBar",{on:{changed:t.filterByDate,searched:t.searchItem}})],1),e("div",{staticClass:"recycler"}),e("div",{staticClass:"scrollable-tab"},[e("table",{staticClass:"table stats"},[t._m(0),e("tbody",{attrs:{id:"stats"}},t._l(t.stats,(function(s){return e("tr",[e("th",[t._v(t._s(s.id))]),e("td",[t._v(t._s(s.nom))]),e("td",[t._v(t._s(s.tel))])])})),0)])])])},ha=[function(){var t=this,e=t._self._c;return e("thead",[e("tr",{staticClass:"panier-item"},[e("th",[t._v("id")]),e("th",[t._v("client")]),e("th",[t._v("télephone")])])])}],pa={components:{SearchBar:T},data(){return{query_date:!1,stats:[]}},methods:{searchItem(t){let e={};if(""==t)return this.fetchData();e=this.query_date||""==t?this.stats.filter((e=>e.id==t|e.nom.toLowerCase().includes(t.toLowerCase()))):this.$store.state.stats.filter((e=>e.id==t|e.nom.toLowerCase().includes(t.toLowerCase()))),this.stats=e},filterByDate(t){let e=t.du,s=t.au,a={headers:{Authorization:"Bearer "+this.$store.state.user.access}};n().get(this.$store.state.url+"/client/"+e+"/"+s+"/",a).then((t=>{this.query_date=!0,this.stats=t.data.results})).catch((t=>{this.query_date=!1,console.error(t)}))},fetchData(){let t={headers:{Authorization:"Bearer "+this.$store.state.user.access}};n().get(this.$store.state.url+"/client/",t).then((t=>{this.$store.state.stats=t.data,this.stats=t.data.results,console.log(t.data)})).catch((t=>{}))}},computed:{total(){let t=0;for(let e of this.stats)t+=e.total;return t}},mounted(){this.fetchData()}},ma=pa,va=(0,h.Z)(ma,da,ha,!1,null,"09443ee8",null),_a=va.exports,fa=function(){var t=this,e=t._self._c;return e("div",{staticClass:"parent",on:{click:function(e){t.popover_opened=!1}}},[e("div",{staticClass:"top"},[e("SearchBar",{on:{changed:t.filterByDate,searched:t.searchItem}})],1),e("div",{staticClass:"recycler"}),e("div",{staticClass:"scrollable-tab"},[e("table",{staticClass:"table pertes"},[t._m(0),e("tbody",{attrs:{id:"pertes"}},t._l(t.pertes,(function(s,a){return e("tr",[e("th",[t._v(t._s(a+1))]),e("td",[t._v(t._s(s.salle))]),e("td",[t._v(t._s(t.datetime(t.since)))]),e("td",[t._v(t._s(t.datetime(t.to)))]),e("td",[t._v(t._s(s.quantite)+" poulles")]),e("td",[t._v(t._s(t.money(s.total)))])])})),0),e("tfoot",[e("tr",{staticClass:"panier-item"},[e("th",{attrs:{colspan:"5"}},[t._v("total")]),e("th",[t._v(t._s(t.money(t.total))+" Fbu")])])])])])])},ga=[function(){var t=this,e=t._self._c;return e("thead",[e("tr",{staticClass:"panier-item"},[e("th",[t._v("id")]),e("th",[t._v("salle")]),e("th",[t._v("du")]),e("th",[t._v("au")]),e("th",[t._v("quantité perdu")]),e("th",[t._v("prix de vente")])])])}],ba={components:{SearchBar:T},data(){return{query_date:!1,pertes:[],to:String(new Date),since:new Date((new Date).setUTCDate((new Date).getUTCDate()-7))}},computed:{total(){let t=0;if(0==this.pertes.length)return t;for(let e of this.pertes)t+=e.total;return t}},methods:{searchItem(t){let e={};if(""==t)return this.fetchData();e=(this.query_date,this.pertes.filter((e=>e.id==t|e.produit.toLowerCase().includes(t.toLowerCase())))),this.pertes=e},filterByDate(t){this.since=t.du,this.to=t.au;let e={headers:{Authorization:"Bearer "+this.$store.state.user.access}};n().get(this.$store.state.url+"/perte/stats/"+this.since+"/"+this.to+"/",e).then((t=>{this.query_date=!0,this.pertes=t.data,console.log(this.pertes)})).catch((t=>{this.query_date=!1,console.error(t)}))},fetchData(){let t={headers:{Authorization:"Bearer "+this.$store.state.user.access}};n().get(this.$store.state.url+"/perte/stats/",t).then((t=>{this.pertes=t.data})).catch((t=>{}))}},mounted(){this.fetchData()}},ya=ba,xa=(0,h.Z)(ya,fa,ga,!1,null,"e69ec146",null),$a=xa.exports,Ca=function(){var t=this,e=t._self._c;return e("div",{staticClass:"parent",on:{click:function(e){t.popover_opened=!1}}},[e("div",{staticClass:"top"},[e("SearchBar",{attrs:{show_date:!1},on:{searched:t.searchItem}})],1),e("label",[e("button",{staticStyle:{float:"right","margin-right":"50px"},on:{click:function(e){t.perte_shown=!0}}},[t._v("ajouter")])]),e("div",{staticClass:"recycler"}),e("div",{staticClass:"scrollable-tab"},[e("table",{staticClass:"table items"},[e("thead",[e("tr",{staticClass:"panier-item",staticStyle:{"text-transform":"capitalize"}},[e("th",[t._v("#")]),e("th",[t._v("Utilisateur")]),e("th",[t._v("Salle")]),e("th",[t._v("date")]),e("th",[t._v("quantité perdu")]),e("th",[t._v("prix vente")]),e("th",[t._v("motif")]),t.userIs("admin")?e("th",[t._v("Action")]):t._e()])]),e("tbody",{attrs:{id:"pertes"}},t._l(t.items,(function(s,a){return s.validated?t._e():e("tr",[e("td",[t._v(t._s(a+1))]),e("td",[t._v(t._s(s.user.username))]),e("td",[t._v(t._s(s.salle))]),e("td",[t._v(t._s(t.datetime(s.date)))]),e("td",[t._v(t._s(s.quantite)+" poulles")]),e("td",[t._v(t._s(t.money(s.prix_unitaire*s.quantite)))]),e("td",[t._v(t._s(s.commentaire))]),t.userIs("admin")?e("td",[e("button",{on:{click:function(e){return t.acceptPerte(s)}}},[t._v("Accepter")]),e("button",{on:{click:function(e){return t.deletePerte(s)}}},[t._v("Refuser")])]):t._e()])})),0),e("tfoot",[e("tr",{staticClass:"panier-item"},[e("th",{attrs:{colspan:"5"}},[t._v("total")]),e("th",[t._v(t._s(t.money(t.total))+" Fbu")])])])])]),e("PerteDialog",{attrs:{visible:t.perte_shown},on:{"update:visible":function(e){t.perte_shown=e},close:function(e){t.perte_shown=!1},added:t.pushPerte}})],1)},wa=[],qa=function(){var t=this,e=t._self._c;return e("div",{class:{popup:!0,active:t.visible},on:{click:t.close}},[e("div",{staticClass:"popup-body",on:{click:function(t){t.preventDefault(),t.stopPropagation()},keydown:function(t){t.stopPropagation()}}},[e("center",[e("h3",[t._v("Perte Poulet")])]),e("form",{attrs:{method:"post"}},[e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_nom"}},[t._v("Nom du salle")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.nom_salle,expression:"nom_salle"}],attrs:{type:"text",list:"noms"},domProps:{value:t.nom_salle},on:{input:function(e){e.target.composing||(t.nom_salle=e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_quantite"}},[t._v("Quantité")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.quantite,expression:"quantite"}],attrs:{type:"number"},domProps:{value:t.quantite},on:{input:function(e){e.target.composing||(t.quantite=e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_quantite"}},[t._v("Prix")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.prix_unitaire,expression:"prix_unitaire"}],attrs:{type:"number"},domProps:{value:t.prix_unitaire},on:{input:function(e){e.target.composing||(t.prix_unitaire=e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_tel"}},[t._v("Détails")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.commentaire,expression:"commentaire"}],attrs:{list:"tels"},domProps:{value:t.commentaire},on:{input:function(e){e.target.composing||(t.commentaire=e.target.value)}}})]),e("div",{staticClass:"buttons"},[e("div",{staticClass:"logs"},[t._v(t._s(t.logs))]),e("input",{attrs:{type:"submit",value:"Soumettre"},on:{click:t.postPerte}})])]),e("datalist",{attrs:{id:"noms"}},t._l(t.salles,(function(t){return e("option",{domProps:{value:t.nom}})})),0)],1)])},ka=[],Pa={props:{visible:{type:Boolean,default:!1}},data(){return{logs:"",nom_salle:"",quantite:0,commentaire:"",prix_unitaire:0}},computed:{salles(){return this.$store.state.salles}},methods:{close(){this.$emit("close")},postPerte(){let t={headers:{Authorization:"Bearer "+this.$store.state.user.access}},e=this.$store.state.salles.find((t=>t.nom==this.nom_salle)),s={salle:e.id,quantite:this.quantite,commentaire:this.commentaire,prix_unitaire:this.prix_unitaire};s.quantite<=0?this.logs="cette quantité est invalide":s.commentaire.length<7?this.logs="vous devez donner un justification valide":n().post(this.$store.state.url+"/perte/",s,t).then((t=>{this.$emit("added",t.data),e.quantite-=t.data.quantite,this.close()})).catch((t=>{t.response?this.logs=t.response.data.status:(this.logs="une erreur est survenue",console.error(t))}))}}},Da=Pa,Sa=(0,h.Z)(Da,qa,ka,!1,null,"8d5b3b5a",null),Ba=Sa.exports,Aa={components:{SearchBar:T,PerteDialog:Ba},data(){return{items:[],perte_shown:!1}},computed:{total(){let t=0;for(let e of this.items)e.validated||(t+=e.prix_unitaire*e.quantite);return t},headers(){return{headers:{Authorization:"Bearer "+this.$store.state.user.access}}}},methods:{userIs(t){return this.$store.state.user.groups.includes(t)},searchItem(t){let e=this.$store.state.pertes.filter((e=>e.id==t|e.produit.toLowerCase().includes(t.toLowerCase())));this.items=e},pushPerte(t){this.items.push(t)},acceptPerte(t){if(confirm("Acceptez-vous vraiment cette perte?")){console.log("triggered");let e={validated:!0};n().patch(this.$store.state.url+`/perte/${t.id}/`,e,this.headers).then((e=>{t.validated=!0})).catch((t=>{console.error(t)}))}},deletePerte(t){if(confirm("Etes vous sur de supprimer cette perte?\nNB: Si vous supprimez cette perte, sa quantité sera réajoutée dans le stock de la salle")){n()["delete"](this.$store.state.url+`/perte/${t.id}/`,this.headers).then((e=>{this.items.splice(this.items.indexOf(t),1),this.$store.state.salles.find((e=>e.id==t.salle_id)).quantite+=t.quantite})).catch((t=>{console.error(t)}))}}},mounted(){n().get(this.$store.state.url+"/perte/",this.headers).then((t=>{this.$store.state.pertes=t.data,this.items=t.data.results})).catch((t=>{console.error(t)}))}},Na=Aa,Ta=(0,h.Z)(Na,Ca,wa,!1,null,"6cb3175a",null),Oa=Ta.exports,La=function(){var t=this,e=t._self._c;return e("div",{staticClass:"parent",on:{click:function(e){t.popover_opened=!1}}},[e("div",{staticClass:"top"},[e("SearchBar",{attrs:{show_date:!1},on:{searched:t.searchItem}})],1),e("label",[e("button",{staticStyle:{float:"right","margin-right":"50px"},on:{click:function(e){t.perte_shown=!0}}},[t._v("ajouter")])]),e("div",{staticClass:"recycler"}),e("div",{staticClass:"scrollable-tab"},[e("table",{staticClass:"table items"},[e("thead",[e("tr",{staticClass:"panier-item",staticStyle:{"text-transform":"capitalize"}},[e("th",[t._v("id")]),e("th",[t._v("Utilisateur")]),e("th",[t._v("Salle")]),e("th",[t._v("date")]),e("th",[t._v("quantité perdu")]),e("th",[t._v("prix vente")]),e("th",[t._v("motif")]),t.userIs("admin")?e("th",[t._v("Action")]):t._e()])]),e("tbody",{attrs:{id:"pertes"}},t._l(t.items,(function(s){return s.validated?t._e():e("tr",[e("td",[t._v(t._s(s.id))]),e("td",[t._v(t._s(s.user.username))]),e("td",[t._v(t._s(s.salle))]),e("td",[t._v(t._s(t.datetime(s.date)))]),e("td",[t._v(t._s(s.quantite))]),e("td",[t._v(t._s(t.money(s.prix_unitaire*s.quantite)))]),e("td",[t._v(t._s(s.commentaire))]),t.userIs("admin")?e("td",[e("button",{on:{click:function(e){return t.acceptPerte(s)}}},[t._v("Accepter")]),e("button",{on:{click:function(e){return t.deletePerte(s)}}},[t._v("Refuser")])]):t._e()])})),0),e("tfoot",[e("tr",{staticClass:"panier-item"},[e("th",{attrs:{colspan:"5"}},[t._v("total")]),e("th",[t._v(t._s(t.money(t.total))+" Fbu")]),e("th")])])])]),e("PerteDialog",{attrs:{visible:t.perte_shown},on:{"update:visible":function(e){t.perte_shown=e},close:function(e){t.perte_shown=!1},added:t.pushPerte}})],1)},Ia=[],Ea=function(){var t=this,e=t._self._c;return e("div",{class:{popup:!0,active:t.visible},on:{click:t.close}},[e("div",{staticClass:"popup-body",on:{click:function(t){t.preventDefault(),t.stopPropagation()},keydown:function(t){t.stopPropagation()}}},[e("center",[e("h3",[t._v("Perte Oeuf")])]),e("form",{attrs:{method:"post"}},[e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_quantite"}},[t._v("Quantité")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.quantite,expression:"quantite"}],attrs:{type:"number"},domProps:{value:t.quantite},on:{input:function(e){e.target.composing||(t.quantite=e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_tel"}},[t._v("Détails")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.commentaire,expression:"commentaire"}],attrs:{list:"tels"},domProps:{value:t.commentaire},on:{input:function(e){e.target.composing||(t.commentaire=e.target.value)}}})]),e("div",{staticClass:"buttons"},[e("div",{staticClass:"logs"},[t._v(t._s(t.logs))]),e("input",{attrs:{type:"submit",value:"Soumettre"},on:{click:t.postPerte}})])]),e("datalist",{attrs:{id:"noms"}},t._l(t.salles,(function(t){return e("option",{domProps:{value:t.nom}})})),0)],1)])},Fa=[],za={props:{visible:{type:Boolean,default:!1}},data(){return{logs:"",nom_salle:"",quantite:0,commentaire:"",prix_unitaire:0}},computed:{salles(){return this.$store.state.salles}},methods:{close(){this.$emit("close")},postPerte(){let t={headers:{Authorization:"Bearer "+this.$store.state.user.access}},e=this.$store.state.salles.find((t=>t.nom==this.nom_salle)),s={salle:e.id,quantite:this.quantite,commentaire:this.commentaire,prix_unitaire:this.prix_unitaire};s.quantite<=0?this.logs="cette quantité est invalide":s.commentaire.length<7?this.logs="vous devez donner un justification valide":n().post(this.$store.state.url+"/perte/",s,t).then((t=>{this.$emit("added",t.data),e.quantite-=t.data.quantite,this.close()})).catch((t=>{t.response?this.logs=t.response.data.status:(this.logs="une erreur est survenue",console.error(t))}))}}},Za=za,ja=(0,h.Z)(Za,Ea,Fa,!1,null,"a3a3fa3e",null),Ua=ja.exports,Va={components:{SearchBar:T,PerteDialog:Ua},data(){return{items:[],perte_shown:!1}},computed:{total(){let t=0;for(let e of this.items)e.validated||(t+=e.prix_unitaire*e.quantite);return t},headers(){return{headers:{Authorization:"Bearer "+this.$store.state.user.access}}}},methods:{userIs(t){return this.$store.state.user.groups.includes(t)},searchItem(t){let e=this.$store.state.pertes.filter((e=>e.id==t|e.produit.toLowerCase().includes(t.toLowerCase())));this.items=e},pushPerte(t){this.items.push(t)},acceptPerte(t){if(confirm("Acceptez-vous vraiment cette perte?")){console.log("triggered");let e={validated:!0};n().patch(this.$store.state.url+`/perte/${t.id}/`,e,this.headers).then((e=>{t.validated=!0})).catch((t=>{console.error(t)}))}},deletePerte(t){if(confirm("Etes vous sur de supprimer cette perte?\nNB: Si vous supprimez cette perte, sa quantité sera réajoutée dans le stock de la salle")){n()["delete"](this.$store.state.url+`/perte/${t.id}/`,this.headers).then((e=>{this.items.splice(this.items.indexOf(t),1),this.$store.state.salles.find((e=>e.id==t.salle_id)).quantite+=t.quantite})).catch((t=>{console.error(t)}))}}},mounted(){n().get(this.$store.state.url+"/perte/",this.headers).then((t=>{this.$store.state.pertes=t.data,this.items=t.data.results})).catch((t=>{console.error(t)}))}},Ra=Va,Qa=(0,h.Z)(Ra,La,Ia,!1,null,"d4498c02",null),Ja=(Qa.exports,function(){var t=this,e=t._self._c;return e("div",{staticClass:"parent",on:{click:function(e){t.popover_opened=!1}}},[e("div",{staticClass:"top"},[e("SearchBar",{attrs:{show_date:!1},on:{searched:t.searchItem}})],1),e("div",{staticClass:"recycler"}),e("div",{staticClass:"scrollable-tab"},[e("table",{staticClass:"table users"},[e("thead",[e("tr",{staticClass:"panier-item"},[e("th",[t._v("#")]),e("th",[t._v("username")]),e("th",[t._v("prenom")]),e("th",[t._v("nom")]),e("th",[t._v("actif")]),e("th",[t._v("groupes")]),e("th",[t._v("options")]),e("th",[e("button",{staticStyle:{float:"right","margin-right":"50px"},on:{click:function(e){t.user_shown=!0}}},[t._v("Ajouter")])])])]),e("tbody",{attrs:{id:"users"}},t._l(t.users,(function(s,a){return e("tr",[e("td",[t._v(t._s(a+1))]),e("td",[t._v(t._s(s.username))]),e("td",[t._v(t._s(s.first_name))]),e("td",[t._v(t._s(s.last_name))]),e("td",[t._v(t._s(s.is_active))]),e("td",{staticClass:"groups"},t._l(s.groups,(function(s){return e("span",[t._v(" "+t._s(s)),e("span",{staticClass:"comma"},[t._v(",")])])})),0),e("td",[e("div",{staticClass:"btns"},[t.permited(s)?e("button",{on:{click:function(e){return t.editUser(s)}}},[t._v(" editer ")]):t._e(),t.editable(s)?e("span",[s.is_active?e("button",{on:{click:function(e){return t.deactivateUser(s)}}},[t._v("desactiver")]):e("button",{on:{click:function(e){return t.activateUser(s)}}},[t._v("activer")])]):t._e()])]),e("td")])})),0)])]),e("EditUser",{attrs:{visible:t.edit_mode,item:t.active_user},on:{close:t.exitEdition}}),e("Adduser",{attrs:{visible:t.user_shown},on:{"update:visible":function(e){t.user_shown=e},close:function(e){t.user_shown=!1}}})],1)}),Ma=[],Ga=function(){var t=this,e=t._self._c;return e("div",{class:{popup:!0,active:t.visible},on:{click:t.close}},[e("div",{staticClass:"popup-body",on:{click:function(t){t.preventDefault(),t.stopPropagation()}}},[t._m(0),e("form",{attrs:{method:"post"}},[e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_username"}},[t._v("Username:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.new_user.username,expression:"new_user.username"}],attrs:{type:"text",id:"id_username"},domProps:{value:t.new_user.username},on:{input:function(e){e.target.composing||t.$set(t.new_user,"username",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_first_name"}},[t._v("Prenom:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.new_user.first_name,expression:"new_user.first_name"}],attrs:{type:"text",id:"id_first_name"},domProps:{value:t.new_user.first_name},on:{input:function(e){e.target.composing||t.$set(t.new_user,"first_name",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_last_name"}},[t._v("Nom:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.new_user.last_name,expression:"new_user.last_name"}],attrs:{type:"text",id:"id_last_name"},domProps:{value:t.new_user.last_name},on:{input:function(e){e.target.composing||t.$set(t.new_user,"last_name",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_first_name"}},[t._v(" Mot de passe: ")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.new_user.password,expression:"new_user.password"}],attrs:{type:"password",id:"id_psswd"},domProps:{value:t.new_user.password},on:{input:function(e){e.target.composing||t.$set(t.new_user,"password",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"confirm"}},[t._v(" confirmation: ")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.confirm,expression:"confirm"}],attrs:{type:"password",id:"confirm"},domProps:{value:t.confirm},on:{input:function(e){e.target.composing||(t.confirm=e.target.value)}}})]),t.is_admin?e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_group"}},[t._v("Groupe:")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.group,expression:"group"}],on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.group=e.target.multiple?s:s[0]}}},t._l(t.groups,(function(s){return e("option",{domProps:{selected:t.user.groups.includes(s),value:s}},[t._v(" "+t._s(s)+" ")])})),0)]):t._e(),e("div",{staticClass:"buttons"},[e("div",{staticClass:"logs"},[t._v(t._s(t.logs))]),e("input",{attrs:{type:"submit",value:"Modifier"},on:{click:t.changerUser}})])])])])},Ha=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"head"},[e("h3",[t._v("Modifier Utilisateur")])])}],Ka={props:{visible:{type:Boolean,default:!1},item:{type:Object,required:!0}},data(){return{logs:"",new_user:{},group:"",groups:["admin","gestionnaire","agent"],confirm:""}},computed:{is_admin(){return this.$store.state.user.is_admin}},watch:{item(t){this.new_user=JSON.parse(JSON.stringify(t))}},methods:{close(){this.$emit("close")},changerUser(){let t={username:this.new_user.username,first_name:this.new_user.first_name,last_name:this.new_user.last_name};if(this.group&&(t["group"]=this.group),this.new_user.password){if(this.new_user.password!=this.confirm)return void(this.logs="les mot de passes doivent être identiques");if(this.new_user.password.length<6)return void(this.logs="le mot de passe doit avoir au moins 6 caractères");t["password"]=this.new_user.password}let e={headers:{Authorization:"Bearer "+this.$store.state.user.access}};n().put(this.$store.state.url+`/user/${this.item.id}/`,t,e).then((t=>{Object.assign(this.item,t.data),this.$emit("close")})).catch((t=>{console.error(t)}))}}},Xa=Ka,Wa=(0,h.Z)(Xa,Ga,Ha,!1,null,"79203df2",null),Ya=Wa.exports,ti=function(){var t=this,e=t._self._c;return e("div",{class:{popup:!0,active:t.visible},on:{click:t.close}},[e("div",{staticClass:"popup-body",on:{click:function(t){t.preventDefault(),t.stopPropagation()}}},[t._m(0),e("form",{attrs:{method:"post"}},[e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_username"}},[t._v("Username:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.user.username,expression:"user.username"}],attrs:{type:"text",id:"id_username"},domProps:{value:t.user.username},on:{input:function(e){e.target.composing||t.$set(t.user,"username",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_first_name"}},[t._v("Prenom:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.user.first_name,expression:"user.first_name"}],attrs:{type:"text",id:"id_first_name"},domProps:{value:t.user.first_name},on:{input:function(e){e.target.composing||t.$set(t.user,"first_name",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_last_name"}},[t._v("Nom:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.user.last_name,expression:"user.last_name"}],attrs:{type:"text",id:"id_last_name"},domProps:{value:t.user.last_name},on:{input:function(e){e.target.composing||t.$set(t.user,"last_name",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"id_first_name"}},[t._v(" Mot de passe: ")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.user.password,expression:"user.password"}],attrs:{type:"password",id:"id_psswd"},domProps:{value:t.user.password},on:{input:function(e){e.target.composing||t.$set(t.user,"password",e.target.value)}}})]),e("div",{staticClass:"field"},[e("label",{attrs:{for:"confirm"}},[t._v(" confirmation: ")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.confirm,expression:"confirm"}],attrs:{type:"password",id:"confirm"},domProps:{value:t.confirm},on:{input:function(e){e.target.composing||(t.confirm=e.target.value)}}})]),e("div",{staticClass:"buttons"},[e("div",{staticClass:"logs"},[t._v(t._s(t.logs))]),e("input",{attrs:{type:"submit",value:"Créer"},on:{click:t.addUser}})])])])])},ei=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"head"},[e("h3",[t._v("Ajouter Utilisateur")])])}],si={props:{visible:{type:Boolean,default:!1}},data(){return{logs:"",group:"",groups:["admin","gestionnaire","agent"],confirm:""}},computed:{is_admin(){return this.$store.state.user.is_admin}},methods:{close(){this.$emit("close")},addUser(){let t={username:this.user.username,first_name:this.user.first_name,last_name:this.user.last_name};if(this.group&&(t["group"]=this.group),this.user.password){if(this.user.password!=this.confirm)return void(this.logs="les mot de passes doivent être identiques");if(this.user.password.length<6)return void(this.logs="le mot de passe doit avoir au moins 6 caractères");t["password"]=this.user.password}let e={headers:{Authorization:"Bearer "+this.$store.state.user.access}};n().post(this.$store.state.url+"/user/",t,e).then((t=>{this.$emit("close"),Object.assign(this.$store.state.users,t.data)})).catch((t=>{console.error(t)}))}}},ai=si,ii=(0,h.Z)(ai,ti,ei,!1,null,"52b03d3a",null),ri=ii.exports,oi={components:{SearchBar:T,EditUser:Ya,Adduser:ri},data(){return{query_date:!1,edit_mode:!1,users:this.$store.state.users,details_opened:!1,active_user:{groups:[]},user_shown:!1}},computed:{},methods:{editable(t){return this.$store.state.user.is_admin&&t.id!=this.$store.state.user.id},permited(t){return this.$store.state.user.is_admin||this.$store.state.user.id==t.id},searchItem(t){let e={};if(""==t)return this.fetchData();e=this.query_date||""==t?this.users.filter((e=>e.id==t|e.client.toLowerCase().includes(t.toLowerCase()))):this.$store.state.users.filter((e=>e.id==t|e.client.toLowerCase().includes(t.toLowerCase()))),this.users=e},fetchData(){let t={headers:{Authorization:"Bearer "+this.$store.state.user.access}};0==this.$store.state.users.length&&n().get(this.$store.state.url+"/user/",t).then((t=>{this.$store.state.users=t.data.results,this.users=t.data.results,console.log(t.data.results)})).catch((t=>{t.response||console.error(t)}))},headers(){return{headers:{Authorization:"Bearer "+this.$store.state.user.access}}},deactivateUser(t){confirm("voulez-vous vraiment arreter cette utilisateur?")&&n().put(this.$store.state.url+`/user/${t.id}/`,{is_active:!1},this.headers()).then((e=>{Object.assign(t,e.data)})).catch((t=>{console.error(t)}))},activateUser(t){confirm("voulez-vous mettre cette utilisateur en action?")&&n().put(this.$store.state.url+`/user/${t.id}/`,{is_active:!0},this.headers()).then((e=>{Object.assign(t,e.data)})).catch((t=>{console.error(t)}))},exitEdition(t){this.edit_mode=!1,this.user_shown=!1},editUser(t){this.edit_mode=!0,this.active_user=t}},mounted(){n().get(this.$store.state.url+"/user/",this.headers).then((t=>{this.$store.state.users=t.data,this.items=t.data.results})).catch((t=>{console.error(t)})),this.fetchData()}},ni=oi,li=(0,h.Z)(ni,Ja,Ma,!1,null,"e2be0462",null),ui=li.exports,ci=function(){var t=this,e=t._self._c;return e("div",{staticClass:"parent",on:{click:function(e){t.popover_opened=!1}}},[e("div",{staticClass:"top"},[e("SearchBar",{attrs:{show_date:t.userIs("admin")||t.userIs("gestionnaire")},on:{changed:t.filterByDate,searched:t.performFilter}})],1),e("div",{staticClass:"recycler"}),e("div",{staticClass:"scrollable-tab"},[e("table",{staticClass:"table commandes"},[t._m(0),e("tbody",{attrs:{id:"commandes"}},t._l(t.items,(function(s,a){return e("tr",[e("td",[t._v(t._s(a+1))]),e("td",[t._v(t._s(t.datetime(s.date)))]),e("td",[t._v(t._s(s.salle))]),e("td",[t._v(t._s(s.client))]),e("td",[t._v(t._s(s.prix_unitaire)+" Fbu")]),e("td",[t._v(t._s(s.poids)+" kg")]),e("td",[t._v(t._s(s.quantite))]),e("td",[t._v(t._s(t.money(s.prix_unitaire*s.quantite))+" Fbu")])])})),0),e("tfoot",[e("tr",{staticClass:"panier-item"},[e("th",{attrs:{colspan:"6"}},[t._v("Total")]),e("th",[t._v(t._s(t.totale())+" poulets")]),e("th",[t._v(t._s(t.money(t.total()))+" Fbu")])])])])]),e("DetailsDialog",{attrs:{visible:t.details_opened,commande:t.active_commande},on:{close:function(e){t.details_opened=!1}}})],1)},di=[function(){var t=this,e=t._self._c;return e("thead",[e("tr",{staticClass:"panier-item"},[e("th",[t._v("#")]),e("th",[t._v("Date")]),e("th",[t._v("Salle")]),e("th",[t._v("Client")]),e("th",[t._v("Prix")]),e("th",[t._v("Poids")]),e("th",[t._v("Quantite")]),e("th",[t._v("Total")])])])}],hi={components:{SearchBar:T,DetailsDialog:Gs},data(){return{query_date:!1,items:this.$store.state.pouletVendus,details_opened:!1,active_commande:{}}},watch:{"$store.state.items"(t){this.items=t}},methods:{total(){let t=0;for(let e of this.items)t+=e.prix_unitaire*e.quantite;return t},totale(){let t=0;for(let e of this.items)t+=e.quantite;return t},userIs(t){return this.$store.state.user.groups.includes(t)},performFilter(t){let e=this.$store.state.pouletVendus.filter((e=>e.id==t|e.client.toLowerCase().includes(t.toLowerCase())|e.date.toLowerCase().includes(t.toLowerCase())));this.items=e},fetchData(){let t={headers:{Authorization:"Bearer "+this.$store.state.user.access}};n().get(this.$store.state.url+"/poulle_vendu/",t).then((t=>{this.$store.state.pouletVendus=t.data.results,this.items=t.data.results,this.$store.state.commandes_fetched=!0})).catch((t=>{if("token_not_valid"==t.response.data.code){let t={refresh:this.$store.state.user.refresh};n().post(this.$store.state.url+"/refresh/",t).then((t=>{this.$store.state.user.access=t.data.access,this.fetchData()})).catch((t=>{this.$store.state.user=null}))}}))},filterByDate(t){let e=t.du,s=t.au,a={headers:{Authorization:"Bearer "+this.$store.state.user.access}};n().get(this.$store.state.url+`/poulle_vendu/?du=${e}&au=${s}`,a).then((t=>{this.query_date=!0,this.items=t.data.results})).catch((t=>{this.query_date=!1,console.log(t)}))}},mounted(){this.fetchData()}},pi=hi,mi=(0,h.Z)(pi,ci,di,!1,null,"6b0026a9",null),vi=mi.exports;a.ZP.use(q.ZP);const _i=[{path:"/",name:"",component:gt},{path:"/home",name:"home",component:gt},{path:"/stock/produit",name:"produit",component:re},{path:"/stock/salle",name:"salle",component:Le},{path:"/stock/oeuf",name:"oeuf",component:Ye},{path:"/hist/oeuf_vendu",name:"oeuf_vendu",component:ca},{path:"/hist/achats",name:"achats",component:Zs},{path:"/hist/rations",name:"rations",component:Ws},{path:"/hist/poulet_vendu",name:"poulet_vendu",component:vi},{path:"/stats/product",name:"statsproduct",component:ia},{path:"/stats/clients",name:"statsclients",component:_a},{path:"/stats/pertes",name:"statspertes",component:$a},{path:"/poulets",name:"poulets",component:Oa},{path:"/users",name:"users",component:ui},{path:"/transactions",name:"transactions",component:Os}],fi=new q.ZP({mode:"history",base:"/",routes:_i});var gi=fi,bi=s(408);a.ZP.use(bi.ZP);var yi=new bi.ZP.Store({state:{user:null,clients:[],url:"/api",produits:[],salles:[],stats:[],oeufs:[],oeufs_vendus:[],achats:[],transactions:[],responsables:[],pertes:[],pouletVendus:[],commandes:[],prix:[],rations:[],users:[],taux:[],achats_fetched:!1,dettes_fetched:!1,commandes_fetched:!1,cart:new Object({content:[],getTotal(){let t=0;for(let e=0;e<this.content.length;e++)t+=this.content[e].getTotal();return t},getLength(){return this.content.length},find(t){for(let e=0;e<this.content.length;e++){let s=this.content[e];if(s.product.id==t)return e}return-1},getQuantite(t){let e=this.find(t);return e>=0?this.content[e].quantite:0},increase(t){let e=this.find(t);if(e>=0){let t=this.content[e];t.quantite<t.product.quantite&&t.quantite++}},decrease(t){let e=this.find(t);if(e>=0){let t=this.content[e];t.quantite>1?t.quantite--:this.content.splice(e,1)}},add(t,e){if(0==t.quantite)return;let s=this.find(t.id);if(s>=0)e&&t.quantite>e?this.content[s].quantite=e:this.increase(t.id);else{let s=new Object({product:t,quantite:e||1,getTotal(){return this.product.prix_unitaire*this.quantite}});this.content.push(s)}}})},mutations:{},actions:{},modules:{}}),xi=s(7979),$i=s(9946),Ci=s(4984),wi=s(1590),qi=s.n(wi);a.ZP.use(qi()),xi.vI.add($i.sq$,$i.IA$,$i.FVb,$i.koM,$i.IwR,$i.I7k,$i.LEp,$i.oFW,$i.oTz,$i.q7m,$i.cf$),a.ZP.component("fa",Ci.GN),a.ZP.mixin({methods:{money(t){return void 0==t||null==t?"-":t.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")},datetime(t){if(!t)return"-";let e=new Date(t);return new Intl.DateTimeFormat("en-GB",{dateStyle:"short",timeStyle:"short"}).format(e)},userIs(t){return this.user.groups.includes(t)}},computed:{user(){return this.$store.state.user}}}),a.ZP.config.productionTip=!1,new a.ZP({router:gi,store:yi,render:t=>t(w)}).$mount("#app")}},e={};function s(a){var i=e[a];if(void 0!==i)return i.exports;var r=e[a]={exports:{}};return t[a].call(r.exports,r,r.exports,s),r.exports}s.m=t,function(){var t=[];s.O=function(e,a,i,r){if(!a){var o=1/0;for(c=0;c<t.length;c++){a=t[c][0],i=t[c][1],r=t[c][2];for(var n=!0,l=0;l<a.length;l++)(!1&r||o>=r)&&Object.keys(s.O).every((function(t){return s.O[t](a[l])}))?a.splice(l--,1):(n=!1,r<o&&(o=r));if(n){t.splice(c--,1);var u=i();void 0!==u&&(e=u)}}return e}r=r||0;for(var c=t.length;c>0&&t[c-1][2]>r;c--)t[c]=t[c-1];t[c]=[a,i,r]}}(),function(){s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,{a:e}),e}}(),function(){s.d=function(t,e){for(var a in e)s.o(e,a)&&!s.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};s.O.j=function(e){return 0===t[e]};var e=function(e,a){var i,r,o=a[0],n=a[1],l=a[2],u=0;if(o.some((function(e){return 0!==t[e]}))){for(i in n)s.o(n,i)&&(s.m[i]=n[i]);if(l)var c=l(s)}for(e&&e(a);u<o.length;u++)r=o[u],s.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return s.O(c)},a=self["webpackChunkinkoko_ui"]=self["webpackChunkinkoko_ui"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=s.O(void 0,[998],(function(){return s(7541)}));a=s.O(a)})();
//# sourceMappingURL=app.dbc8bf0f.js.map